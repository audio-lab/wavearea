import{a as O,c as S}from"./chunk-A576P2ZR.js";var b=O((v,$)=>{$.exports=Worker});var B=(n,p)=>{Object.defineProperty(n,"name",{value:p})};function o(n){let p=Uint8Array,f=Float32Array;o.modules||Object.defineProperties(o,{modules:{value:new WeakMap},setModule:{value(e,s){o.modules.set(e,Promise.resolve(s))}},getModule:{value(e,s){let t=o.modules.get(e);return t||(s?t=WebAssembly.compile(o.decodeDynString(s)):(s=e.wasm,t=o.inflateDynEncodeString(s).then(U=>WebAssembly.compile(U))),o.modules.set(e,t)),t}},concatFloat32:{value(e,s){let t=new f(s),U=0,r=0;for(;U<e.length;)t.set(e[U],r),r+=e[U++].length;return t}},getDecodedAudio:{value:(e,s,t,U,r)=>({errors:e,channelData:s,samplesDecoded:t,sampleRate:U,bitDepth:r})},getDecodedAudioMultiChannel:{value(e,s,t,U,r,h){let a=[],u,l;for(u=0;u<t;u++){let i=[];for(l=0;l<s.length;)i.push(s[l++][u]||[]);a.push(o.concatFloat32(i,U))}return o.getDecodedAudio(e,a,U,r,h)}},decodeDynString:{value(e){let s=new p(e.length),t=parseInt(e.substring(11,13),16),U=256-t,r=!1,h=0,a,u=13;for(;u<e.length;){if(a=e.charCodeAt(u++),a===61&&!r){r=!0;continue}r&&(r=!1,a-=64),s[h++]=a<t&&a>0?a+U:a-t}return s.subarray(0,h)}},inflateDynEncodeString:{value(e){return e=o.decodeDynString(e),new Promise(s=>{let t=String.raw`dynEncode0014u*ttt$#U¤¤U¤¤3yzzss|yusvuyÚ&4<054<,5T44^T44<(6U~J(44< ~A544U~6J0444545 444J0444J,4U4UÒ7U454U4Z4U4U^/6545T4T44BU~64CU~O4U54U~5 U5T4B4Z!4U~5U5U5T4U~6U4ZTU5U5T44~4O4U2ZTU5T44Z!4B6T44U~64B6U~O44U~4O4U~54U~5 44~C4~54U~5 44~5454U4B6Ub!444~UO4U~5 U54U4ZTU#44U$464<4~B6^4<444~U~B4U~54U544~544~U5 µUä#UJUè#5TT4U0ZTTUX5U5T4T4Uà#~4OU4U $~C4~54U~5 T44$6U\!TTT4UaT4<6T4<64<Z!44~4N4<U~5 4UZ!4U±_TU#44UU6UÔ~B$544$6U\!4U6U¤#~B44Uä#~B$~64<6_TU#444U~B~6~54<Y!44<_!T4Y!4<64~444~AN44<U~6J4U5 44J4U[!U#44UO4U~54U~5 U54 7U6844J44J 4UJ4UJ04VK(44<J44<J$4U´~54U~5 4U¤~5!TTT4U$5"U5TTTTTTT4U$"4VK,U54<(6U~64<$6_!4< 64~6A54A544U~6#J(U54A4U[!44J(44#~A4U6UUU[!4464~64_!4<64~54<6T4<4]TU5 T4Y!44~44~AN4U~54U~54U5 44J(44J UÄA!U5U#UôJU"UÔJU#UÔ"JU#U´"JT4U´ZTU5T4UôZTU5T4UDZTU5T4U$[T44~UO4U~5 UÔUô4U~U´$.U5T4UP[T4U~4~UO4U~5 U#<U#<4U~U2$.UÄUN 44 ~UO4U~5 44!~UO4U~5 4U~4~UO4U~5 44J44J(U5 44U¤~J@44Uä~J<44UD~J844U~J44U$54U$5U54U$54U1^4U1^!4U~54U~5U54U~6U4U^/65T4T4U$54U~4BU~4O4U54U~5 UU'464U'_/54UU~5T4T4U~4BU~UO4U54U~5 U54Uä~4U¤~4U~U'$!44~5U5T44\T44U<~$6U\!4U#aT4U~4U~4O4U~5 U5U5U5TTT4U$"4YTU5 4U4~C5U5 U5U5444$4~64~\TU5 4U~4U~5T4Y!44O4U~54U~54U5 4CYTU5 4Uä~4U¤~4U~4$6TU54U\!44Bæ4Bä~[!4U~4UD~4U~4U~4$6TU54U\!44B4B~[!44U<~4U4~$5 4U"U#$544"Y!454U^!44<J44<(J454U~84­UN!#%'+/37?GOWgw·×÷Uä;U9$%& !"#`;o.getModule(o,t).then(U=>WebAssembly.instantiate(U,{})).then(({exports:U})=>{let r=new Map(Object.entries(U)),h=r.get("puff"),a=r.get("memory").buffer,u=new p(a),l=new DataView(a),i=r.get("__heap_base"),d=e.length,c=i;i+=4,l.setInt32(c,d,!0);let m=i;i+=d,u.set(e,m);let T=i;i+=4,l.setInt32(T,u.byteLength-i,!0),h(i,T,m,c),s(u.slice(i,i+l.getInt32(T,!0)))})})}}}),Object.defineProperty(this,"wasm",{enumerable:!0,get:()=>this._wasm}),this.getOutputChannels=(e,s,t)=>{let U=[],r=0;for(;r<s;)U.push(e.slice(r*t,r++*t+t));return U},this.allocateTypedArray=(e,s,t=!0)=>{let U=this._wasm._malloc(s.BYTES_PER_ELEMENT*e);return t&&this._pointers.add(U),{ptr:U,len:e,buf:new s(this._wasm.HEAP,U,e)}},this.free=()=>{this._pointers.forEach(e=>{this._wasm._free(e)}),this._pointers.clear()},this.codeToString=e=>{let s=[],t=new Uint8Array(this._wasm.HEAP);for(let U=t[e];U!==0;U=t[++e])s.push(U);return String.fromCharCode.apply(null,s)},this.addError=(e,s,t)=>{e.push({message:s,frameLength:t,frameNumber:n._frameNumber,inputBytes:n._inputBytes,outputSamples:n._outputSamples})},this.instantiate=()=>{let e=n._module,s=n._EmscriptenWASM,t=n._inputSize,U=n._outputChannels,r=n._outputChannelSize;return e&&o.setModule(s,e),this._wasm=new s(o).instantiate(),this._pointers=new Set,this._wasm.ready.then(()=>(t&&(n._input=this.allocateTypedArray(t,p)),r&&(n._output=this.allocateTypedArray(U*r,f)),n._inputBytes=0,n._outputSamples=0,n._frameNumber=0,this))}}var J=S(b(),1);var C=()=>globalThis.Worker||J.default,g=class extends C(){constructor(p,f,e,s){o.modules||new o;let t=o.modules.get(e);if(!t){let U=`'use strict';(${((h,a,u)=>{let l,i,d=new Promise(c=>{i=c});self.onmessage=({data:{id:c,command:m,data:T}})=>{let _=d,y={id:c},w;m==="init"?(Object.defineProperties(h,{WASMAudioDecoderCommon:{value:a},EmscriptenWASM:{value:u},module:{value:T.module},isWebWorker:{value:!0}}),l=new h(T.options),i()):m==="free"?l.free():m==="ready"?_=_.then(()=>l.ready):m==="reset"?_=_.then(()=>l.reset()):(Object.assign(y,l[m](Array.isArray(T)?T.map(A=>new Uint8Array(A)):new Uint8Array(T))),w=y.channelData?y.channelData.map(A=>A.buffer):[]),_.then(()=>self.postMessage(y,w))}}).toString()})(${e}, ${o}, ${s})`,r="text/javascript";try{t=URL.createObjectURL(new Blob([U],{type:r}))}catch{t=`data:${r};base64,${Buffer.from(U).toString("base64")}`}o.modules.set(e,t)}super(t,{name:f}),this._id=Number.MIN_SAFE_INTEGER,this._enqueuedOperations=new Map,this.onmessage=({data:U})=>{let{id:r,...h}=U;this._enqueuedOperations.get(r)(h),this._enqueuedOperations.delete(r)},new s(o).getModule().then(U=>{this._postToDecoder("init",{module:U,options:p})})}async _postToDecoder(p,f){return new Promise(e=>{this.postMessage({command:p,id:this._id,data:f}),this._enqueuedOperations.set(this._id++,e)})}get ready(){return this._postToDecoder("ready")}async free(){await this._postToDecoder("free").finally(()=>{this.terminate()})}async reset(){await this._postToDecoder("reset")}};export{o as a,g as b,B as c};
//# sourceMappingURL=chunk-SCMJQOGN.js.map
