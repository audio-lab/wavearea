var w=class{constructor(t){if(!t)throw TypeError("options argument is required");if(!t.sampleRate)throw TypeError("options.sampleRate is required");if(t.sampleRate<3e3||t.sampleRate>768e3)throw TypeError("options.sampleRate must be within 3000..768000");if(!t.length)throw TypeError("options.length must be more than 0");this.sampleRate=t.sampleRate,this.numberOfChannels=t.numberOfChannels||1,this.length=t.length|0,this.duration=this.length/this.sampleRate,this._data=new Float32Array(this.length*this.numberOfChannels),this._channelData=[];for(let n=0;n<this.numberOfChannels;n++)this._channelData.push(this._data.subarray(n*this.length,(n+1)*this.length))}getChannelData(t){if(t>=this.numberOfChannels||t<0||t==null)throw Error("Cannot getChannelData: channel number ("+t+") exceeds number of channels ("+this.numberOfChannels+")");return this._channelData[t]}copyFromChannel(t,n,r){r==null&&(r=0);for(var s=this._channelData[n],a=r,l=0;a<this.length&&l<t.length;a++,l++)t[l]=s[a]}copyToChannel(t,n,r){var s=this._channelData[n];r||(r=0);for(var a=r,l=0;a<this.length&&l<t.length;a++,l++)s[a]=t[l]}};function A(e){if(e){if(e=new Uint8Array(e.buffer||e),v(e))return"wav";if(E(e))return"mp3";if(M(e))return"flac";if(_(e))return"m4a";if(B(e))return"opus";if(T(e))return"oga";if(F(e))return"qoa"}}function E(e){if(!(!e||e.length<3))return e[0]===73&&e[1]===68&&e[2]===51||e[0]===255&&(e[1]&224)===224||e[0]===84&&e[1]===65&&e[2]===71}function v(e){if(!(!e||e.length<12))return e[0]===82&&e[1]===73&&e[2]===70&&e[3]===70&&e[8]===87&&e[9]===65&&e[10]===86&&e[11]===69}function T(e){if(!(!e||e.length<4))return e[0]===79&&e[1]===103&&e[2]===103&&e[3]===83}function M(e){if(!(!e||e.length<4))return e[0]===102&&e[1]===76&&e[2]===97&&e[3]===67}function _(e){if(!(!e||e.length<8))return e[4]===102&&e[5]===116&&e[6]===121&&e[7]===112||e[0]===77&&e[1]===52&&e[2]===65&&e[3]===32}function B(e){if(!(!e||e.length<36))return e[0]===79&&e[1]===103&&e[2]===103&&e[3]===83&&e[28]===79&&e[29]===112&&e[30]===117&&e[31]===115&&e[32]===72&&e[33]===101&&e[34]===97&&e[35]===100}function F(e){if(e)return e[0]===113&&e[1]===111&&e[2]===97&&e[3]===102}var L=globalThis.AudioBuffer||w;async function R(e){if(!e)throw Error("No decode target");e=new Uint8Array(e.buffer||e);let t=A(e);if(!t)throw Error("Cannot detect audio format");if(!p[t])throw Error("Missing decoder for "+t+" format");return p[t](e)}var p={async oga(e){let{OggVorbisDecoder:t}=await import("./ogg-vorbis-EYH2AVFD.js"),n=new t;return await n.ready,(p.oga=async r=>r&&C(await n.decodeFile(r)))(e)},async mp3(e){let{MPEGDecoder:t}=await import("./mpg123-decoder-B7VNRNCV.js"),n=new t;return await n.ready,(p.mp3=r=>r&&C(n.decode(r)))(e)},async flac(e){let{FLACDecoder:t}=await import("./flac-MWKCJWKK.js"),n=new t;return await n.ready,(p.mp3=async r=>r&&C(await n.decode(r)))(e)},async opus(e){let{OggOpusDecoder:t}=await import("./ogg-opus-decoder-XKBX6M6F.js"),n=new t;return await n.ready,(p.opus=async r=>r&&C(await n.decodeFile(r)))(e)},async wav(e){let t=await import("./node-wav-Z2YOVIIS.js"),{decode:n}=t.default;return(p.wav=r=>r&&C(n(r)))(e)},async qoa(e){let{decode:t}=await import("./qoa-format-2T4G2DZE.js");return(p.qoa=n=>n&&C(t(n)))(e)}};function C({channelData:e,sampleRate:t}){let n=new L({sampleRate:t,length:e[0].length,numberOfChannels:e.length});for(let r=0;r<e.length;r++)n.getChannelData(r).set(e[r]);return n}async function Z(e){console.time("fetch");let t=await fetch(e,{cache:"force-cache"});if(console.timeEnd("fetch"),!t.ok)throw new Error(`HTTP error: status=${t.status}`);let n=await t.arrayBuffer();return R(n)}async function H(...e){console.time("wav encode");let t=e[0]?.sampleRate||44100,n=32,r=e[0]?.numberOfChannels||1,s=0;for(let o of e)s+=o.length;let a=new ArrayBuffer(44+s*r*(n>>3)),l=new DataView(a),h=0,y=o=>l.setUint8(h++,o),g=o=>(l.setUint16(h,o,!0),h+=2),c=o=>(l.setUint32(h,o,!0),h+=4),d=o=>{for(var i=0;i<o.length;++i)y(o.charCodeAt(i))};d("RIFF"),c(a.byteLength-8),d("WAVE"),d("fmt "),c(16),g(3),g(r),c(t),c(t*r*(n>>3)),g(r*(n>>3)),g(n),d("data"),c(a.byteLength-44);let x=new Float32Array(a,h);for(let o of e){let i=o.numberOfChannels,u=Array(i),D=o.length;for(let m=0;m<i;++m)u[m]=o.getChannelData(m);for(let m=0;m<D;++m)for(let O=0;O<i;++O)x[h++]=u[O][m]}return console.timeEnd("wav encode"),a}function Q(e){if(!e)return"";if(e._wf)return e._wf;let t=e.getChannelData(0),n="",r=2,s=128,a=1,l=-1;for(let h=0,y=1024;h<t.length;){let g=0,c=0;for(;h<y;h++){let u=h>=t.length?0:t[h];c+=u,g+=u**2,a=Math.min(a,u),l=Math.max(l,u)}let d=c/1024,x=Math.sqrt(g/1024),o=Math.min(100,Math.ceil(x*s*r/(l-a)))||0;n+=String.fromCharCode(256+o);let i=Math.abs(Math.round(d*s/2));n+=(d>0?"\u0301":"\u0300").repeat(i),y+=1024}return e._wf=n,n}var $=e=>new Promise((t,n)=>{let r=new FileReader;r.addEventListener("loadend",s=>{t(s.target.result)}),r.addEventListener("error",n),r.readAsArrayBuffer(e)});export{w as a,R as b,Z as c,H as d,Q as e,$ as f};
//# sourceMappingURL=chunk-6UM6LLFF.js.map
