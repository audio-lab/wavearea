import"./chunk-ABZDHW4W.js";var C=class{constructor(t,e){this.file=t,this.directory=e,this.state="pending",this.id=null,this.href=null,this.name=null,this.percent=0}static traverse(t,e){return Je(t,e)}static from(t){let e=[];for(let n of t)if(n instanceof File)e.push(new C(n));else if(n instanceof C)e.push(n);else throw new Error("Unexpected type");return e}get fullPath(){return this.directory?`${this.directory}/${this.file.name}`:this.file.name}isImage(){return["image/gif","image/png","image/jpg","image/jpeg","image/svg+xml"].indexOf(this.file.type)>-1}isVideo(){return["video/mp4","video/quicktime"].indexOf(this.file.type)>-1}saving(t){if(this.state!=="pending"&&this.state!=="saving")throw new Error(`Unexpected transition from ${this.state} to saving`);this.state="saving",this.percent=t}saved(t){var e,n,i;if(this.state!=="pending"&&this.state!=="saving")throw new Error(`Unexpected transition from ${this.state} to saved`);this.state="saved",this.id=(e=t?.id)!==null&&e!==void 0?e:null,this.href=(n=t?.href)!==null&&n!==void 0?n:null,this.name=(i=t?.name)!==null&&i!==void 0?i:null}isPending(){return this.state==="pending"}isSaving(){return this.state==="saving"}isSaved(){return this.state==="saved"}};function Je(r,t){return t&&rr(r)?Ht("",nr(r)):Promise.resolve(zt(Array.from(r.files||[])).map(e=>new C(e)))}function Qe(r){return r.name.startsWith(".")}function zt(r){return Array.from(r).filter(t=>!Qe(t))}function tr(r){return new Promise(function(t,e){r.file(t,e)})}function er(r){return new Promise(function(t,e){let n=[],i=r.createReader(),o=()=>{i.readEntries(a=>{a.length>0?(n.push(...a),o()):t(n)},e)};o()})}async function Ht(r,t){let e=[];for(let n of zt(t))if(n.isDirectory)e.push(...await Ht(n.fullPath,await er(n)));else{let i=await tr(n);e.push(new C(i,r))}return e}function rr(r){return r.items&&Array.from(r.items).some(t=>{let e=t.webkitGetAsEntry&&t.webkitGetAsEntry();return e&&e.isDirectory})}function nr(r){return Array.from(r.items).map(t=>t.webkitGetAsEntry()).filter(t=>t!=null)}var O=class extends HTMLElement{connectedCallback(){this.addEventListener("dragenter",et),this.addEventListener("dragover",et),this.addEventListener("dragleave",$t),this.addEventListener("drop",Vt),this.addEventListener("paste",Kt),this.addEventListener("change",Zt)}disconnectedCallback(){this.removeEventListener("dragenter",et),this.removeEventListener("dragover",et),this.removeEventListener("dragleave",$t),this.removeEventListener("drop",Vt),this.removeEventListener("paste",Kt),this.removeEventListener("change",Zt)}get directory(){return this.hasAttribute("directory")}set directory(t){t?this.setAttribute("directory",""):this.removeAttribute("directory")}async attach(t){let e=t instanceof DataTransfer?await C.traverse(t,this.directory):C.from(t);this.dispatchEvent(new CustomEvent("file-attachment-accept",{bubbles:!0,cancelable:!0,detail:{attachments:e}}))&&e.length&&this.dispatchEvent(new CustomEvent("file-attachment-accepted",{bubbles:!0,detail:{attachments:e}}))}};function Gt(r){return Array.from(r.types).indexOf("Files")>=0}var yt=null;function et(r){let t=r.currentTarget;yt&&clearTimeout(yt),yt=window.setTimeout(()=>t.removeAttribute("hover"),200);let e=r.dataTransfer;!e||!Gt(e)||(e.dropEffect="copy",t.setAttribute("hover",""),r.preventDefault())}function $t(r){r.dataTransfer&&(r.dataTransfer.dropEffect="none"),r.currentTarget.removeAttribute("hover"),r.stopPropagation(),r.preventDefault()}function Vt(r){let t=r.currentTarget;if(!(t instanceof O))return;t.removeAttribute("hover");let e=r.dataTransfer;!e||!Gt(e)||(t.attach(e),r.stopPropagation(),r.preventDefault())}var ir=/^image\/(gif|png|jpeg)$/;function or(r){for(let t of r)if(t.kind==="file"&&ir.test(t.type))return t.getAsFile();return null}function Kt(r){if(!r.clipboardData||!r.clipboardData.items)return;let t=r.currentTarget;if(!(t instanceof O))return;let e=or(r.clipboardData.items);if(!e)return;let n=[e];t.attach(n),r.preventDefault()}function Zt(r){let t=r.currentTarget;if(!(t instanceof O))return;let e=r.target;if(!(e instanceof HTMLInputElement))return;let n=t.getAttribute("input");if(n&&e.id!==n)return;let i=e.files;!i||i.length===0||(t.attach(i),e.value="")}window.customElements.get("file-attachment")||(window.FileAttachmentElement=O,window.customElements.define("file-attachment",O));function nt(){throw new Error("Cycle detected")}function Et(){if(V>1)V--;else{for(var r,t=!1;X!==void 0;){var e=X;for(X=void 0,gt++;e!==void 0;){var n=e.o;if(e.o=void 0,e.f&=-3,!(8&e.f)&&Xt(e))try{e.c()}catch(i){t||(r=i,t=!0)}e=n}}if(gt=0,V--,t)throw r}}var w=void 0,X=void 0,V=0,gt=0,rt=0;function qt(r){if(w!==void 0){var t=r.n;if(t===void 0||t.t!==w)return w.s=t={i:0,S:r,p:void 0,n:w.s,t:w,e:void 0,x:void 0,r:t},r.n=t,32&w.f&&r.S(t),t;if(t.i===-1)return t.i=0,t.p!==void 0&&(t.p.n=t.n,t.n!==void 0&&(t.n.p=t.p),t.p=void 0,t.n=w.s,w.s.p=t,w.s=t),t}}function R(r){this.v=r,this.i=0,this.n=void 0,this.t=void 0}R.prototype.h=function(){return!0};R.prototype.S=function(r){this.t!==r&&r.e===void 0&&(r.x=this.t,this.t!==void 0&&(this.t.e=r),this.t=r)};R.prototype.U=function(r){var t=r.e,e=r.x;t!==void 0&&(t.x=e,r.e=void 0),e!==void 0&&(e.e=t,r.x=void 0),r===this.t&&(this.t=e)};R.prototype.subscribe=function(r){var t=this;return bt(function(){var e=t.value,n=32&this.f;this.f&=-33;try{r(e)}finally{this.f|=n}})};R.prototype.valueOf=function(){return this.value};R.prototype.toString=function(){return this.value+""};R.prototype.peek=function(){return this.v};Object.defineProperty(R.prototype,"value",{get:function(){var r=qt(this);return r!==void 0&&(r.i=this.i),this.v},set:function(r){if(r!==this.v){gt>100&&nt(),this.v=r,this.i++,rt++,V++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{Et()}}}});function At(r){return new R(r)}function Xt(r){for(var t=r.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function Jt(r){for(var t=r.s;t!==void 0;t=t.n){var e=t.S.n;e!==void 0&&(t.r=e),t.S.n=t,t.i=-1}}function Qt(r){for(var t=r.s,e=void 0;t!==void 0;){var n=t.n;t.i===-1?(t.S.U(t),t.n=void 0):(e!==void 0&&(e.p=t),t.p=void 0,t.n=e,e=t),t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=n}r.s=e}function Y(r){R.call(this,void 0),this.x=r,this.s=void 0,this.g=rt-1,this.f=4}(Y.prototype=new R).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===rt))return!0;if(this.g=rt,this.f|=1,this.i>0&&!Xt(this))return this.f&=-2,!0;var r=w;try{Jt(this),w=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(e){this.v=e,this.f|=16,this.i++}return w=r,Qt(this),this.f&=-2,!0};Y.prototype.S=function(r){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}R.prototype.S.call(this,r)};Y.prototype.U=function(r){if(R.prototype.U.call(this,r),this.t===void 0){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};Y.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var r=this.t;r!==void 0;r=r.x)r.t.N()}};Y.prototype.peek=function(){if(this.h()||nt(),16&this.f)throw this.v;return this.v};Object.defineProperty(Y.prototype,"value",{get:function(){1&this.f&&nt();var r=qt(this);if(this.h(),r!==void 0&&(r.i=this.i),16&this.f)throw this.v;return this.v}});function te(r){return new Y(r)}function ee(r){var t=r.u;if(r.u=void 0,typeof t=="function"){V++;var e=w;w=void 0;try{t()}catch(n){throw r.f&=-2,r.f|=8,St(r),n}finally{w=e,Et()}}}function St(r){for(var t=r.s;t!==void 0;t=t.n)t.S.U(t);r.x=void 0,r.s=void 0,ee(r)}function ar(r){if(w!==this)throw new Error("Out-of-order effect");Qt(this),w=r,this.f&=-2,8&this.f&&St(this),Et()}function J(r){this.x=r,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}J.prototype.c=function(){var r=this.S();try{!(8&this.f)&&this.x!==void 0&&(this.u=this.x())}finally{r()}};J.prototype.S=function(){1&this.f&&nt(),this.f|=1,this.f&=-9,ee(this),Jt(this),V++;var r=w;return w=this,ar.bind(this,r)};J.prototype.N=function(){2&this.f||(this.f|=2,this.o=X,X=this)};J.prototype.d=function(){this.f|=8,1&this.f||St(this)};function bt(r){var t=new J(r);return t.c(),t.d.bind(t)}Symbol.observable||=Symbol("observable");var re=r=>r&&!!(r[Symbol.observable]||r[Symbol.asyncIterator]||r.call&&r.set||r.subscribe||r.then),ur=new FinalizationRegistry(r=>r.call?.()),sr=r=>r&&(()=>r.unsubscribe?.()),ne=(r,t,e,n,i,o)=>r&&(o=sr((r[Symbol.observable]?.()||r).subscribe?.(t,e,n))||r.set&&r.call?.(i,t)||(r.then?.(a=>(!i&&t(a),n?.()),e)||(async a=>{try{for await(a of r){if(i)return;t(a)}n?.()}catch(u){e?.(u)}})())&&(a=>i=1),ur.register(r,o),o);var ie=r=>r&&r.peek,Rt=r=>r&&r[oe],oe=Symbol("signal-struct");x.isStruct=Rt;function x(r,t){if(Rt(r)&&!t)return r;let e,n;if(_t(r)){e=Object.create(t||Object.getPrototypeOf(r)),n={};let i=Object.getOwnPropertyDescriptors(r);if(Rt(r))for(let o in i)Object.defineProperty(e,o,i[o]);else for(let o in i)n[o]=lr(e,o,i[o].get?te(i[o].get.bind(e)):i[o].value);return Object.defineProperty(e,oe,{configurable:!1,enumerable:!1,value:!0}),e}return Array.isArray(r)?r.map(i=>x(i)):r}function lr(r,t,e){let n,i=ie(e)?e:_t(e)||Array.isArray(e)?At(x(e)):At((n=re(e))?void 0:e);return n&&ne(e,o=>i.value=o),Object.defineProperty(r,t,{get(){return i.value},set:!ie(e)&&_t(e)?o=>o?Object.assign(i.value,o):i.value=x(o):o=>i.value=x(o),enumerable:!0,configurable:!1}),i}function _t(r){return r&&r.constructor===Object}var K=(r,t,e,n=null)=>{let i=0,o,a,u,s=e.length,l=t.length,{remove:h,same:f,insert:d,replace:p}=K;for(;i<s&&i<l&&f(t[i],e[i]);)i++;for(;i<s&&i<l&&f(e[s-1],t[l-1]);)n=e[--l,--s];if(i==l)for(;i<s;)d(n,e[i++],r);else{for(o=t[i];i<s;)u=e[i++],a=o?o.nextSibling:n,f(o,u)?o=a:i<s&&f(e[i],a)?(p(o,u,r),o=a):d(o,u,r);for(;!f(o,n);)a=o.nextSibling,h(o,r),o=a}return e};K.same=(r,t)=>r==t;K.replace=(r,t,e)=>e.replaceChild(t,r);K.insert=(r,t,e)=>e.insertBefore(t,r);K.remove=(r,t)=>t.removeChild(r);var ae=K;var Z={},cr={},fr={},ue=r=>r===null?cr:r===void 0?fr:typeof r=="number"||r instanceof Number?Z[r]||(Z[r]=new Number(r)):typeof r=="string"||r instanceof String?Z[r]||(Z[r]=new String(r)):typeof r=="boolean"||r instanceof Boolean?Z[r]||(Z[r]=new Boolean(r)):r;var E={},se=(r,t,e,n)=>{let i=n.startsWith("on")&&n.slice(2),o=A(r,t,":"+n),a;if(o)return i?u=>{a&&he(r,i,a),a=o(u),a&&fe(r,i,a)}:u=>ot(r,n,o(u))},ot=(r,t,e)=>{e==null||e===!1?r.removeAttribute(t):r.setAttribute(t,e===!0?"":typeof e=="number"||typeof e=="string"?e:"")};E[""]=(r,t)=>{let e=A(r,t,":");if(e)return n=>{let i=e(n);for(let o in i)ot(r,pe(o),i[o])}};var le=Symbol(":each"),xt=Symbol(":ref");E.ref=(r,t,e)=>{if(r.hasAttribute(":each")){r[xt]=t;return}e[t]=r};E.with=(r,t,e)=>{let n=A(r,t,"with");N(r,x(n(e),e))};E.if=(r,t)=>{let e=document.createTextNode(""),n=[A(r,t,":if")],i=[r],o=r;for(;(o=r.nextElementSibling)&&o.hasAttribute(":else");)o.removeAttribute(":else"),(t=o.getAttribute(":if"))?(o.removeAttribute(":if"),o.remove(),i.push(o),n.push(A(r,t,":else :if"))):(o.remove(),i.push(o),n.push(()=>1));return r.replaceWith(o=e),a=>{let u=n.findIndex(s=>s(a));i[u]!=o&&((o[le]||o).replaceWith(o=i[u]||e),N(o,a))}};E.each=(r,t)=>{let e=hr(t);if(!e)return it(new Error,r,t);let n=r[le]=document.createTextNode("");r.replaceWith(n);let i=A(r,e.items,":each"),o=new WeakMap,a=new WeakMap,u=[];return s=>{let l=i(s);l?typeof l=="number"?l=Array.from({length:l},(d,p)=>[p,p+1]):Array.isArray(l)?l=l.map((d,p)=>[p+1,d]):typeof l=="object"?l=Object.entries(l):it(Error("Bad list value"),r,t,":each",l):l=[];let h=[],f=[];for(let[d,p]of l){let v=ue(p),y=a.get(v);if(y||(y=r.cloneNode(!0),a.set(v,y)),h.push(y),!o.has(v)){let b=Object.create(s);b[e.item]=p,e.index&&(b[e.index]=d),r[xt]&&(b[r[xt]]=y),o.set(v,b)}f.push(o.get(v))}ae(n.parentNode,u,h,n),u=h;for(let d=0;d<h.length;d++)N(h[d],f[d])}};function hr(r){let t=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,e=/^\s*\(|\)\s*$/g,n=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,i=r.match(n);if(!i)return;let o={};o.items=i[2].trim();let a=i[1].replace(e,"").trim(),u=a.match(t);return u?(o.item=a.replace(t,"").trim(),o.index=u[1].trim()):o.item=a,o}E.id=(r,t)=>{let e=A(r,t,":id"),n=i=>r.id=i||i===0?i:"";return i=>n(e(i))};E.class=(r,t)=>{let e=A(r,t,":class"),n=r.className;return i=>{let o=e(i);r.className=n+typeof o=="string"?o:(Array.isArray(o)?o:Object.entries(o).map(([a,u])=>u?a:"")).filter(Boolean).join(" ")}};E.style=(r,t)=>{let e=A(r,t,":style"),n=r.getAttribute("style")||"";return n.endsWith(";")||(n+="; "),i=>{let o=e(i);if(typeof o=="string")r.setAttribute("style",n+o);else for(let a in o)r.style[a]=o[a]}};E.text=(r,t)=>{let e=A(r,t,":text");return n=>{let i=e(n);r.textContent=i??""}};E.value=(r,t)=>{let e=A(r,t,":value"),n,i,o=r.type==="text"||r.type===""?a=>r.setAttribute("value",r.value=a??""):r.tagName==="TEXTAREA"||r.type==="text"||r.type===""?a=>(n=r.selectionStart,i=r.selectionEnd,r.setAttribute("value",r.value=a??""),n&&r.setSelectionRange(n,i)):r.type==="checkbox"?a=>(r.value=a?"on":"",ot(r,"checked",a)):r.type==="select-one"?a=>{for(let u in r.options)u.removeAttribute("selected");r.value=a,r.selectedOptions[0]?.setAttribute("selected","")}:a=>r.value=a;return a=>o(e(a))};var ce=Symbol("stop");E.on=(r,t)=>{let e=A(r,t,":on"),n={};return i=>{for(let o in n)he(r,o,n[o]);n=e(i);for(let o in n)fe(r,o,n[o])}};var fe=(r,t,e)=>{if(t.indexOf("..")<0)r.addEventListener(t,e);else{let n=t.split("..").map(o=>o.startsWith("on")?o.slice(2):o),i=(o,a=0)=>{let u=s=>{r.removeEventListener(n[a],u),typeof(o=o.call(r,s))!="function"&&(o=()=>{}),++a<n.length?i(o,a):e[ce]||i(e)};r.addEventListener(n[a],u)};i(e)}},he=(r,t,e)=>{t.indexOf("..")>=0&&(e[ce]=!0),r.removeEventListener(t,e)};E.data=(r,t)=>{let e=A(r,t,":data");return n=>{let i=e(n);for(let o in i)r.dataset[o]=i[o]}};E.aria=(r,t)=>{let e=A(r,t,":aria"),n=i=>{for(let o in i)ot(r,"aria-"+pe(o),i[o]==null?null:i[o]+"")};return i=>n(e(i))};var Tt={};function A(r,t,e){if(Tt[t])return Tt[t];let n=/^[\n\s]*if.*\(.*\)/.test(t)||/^(let|const)\s/.test(t)?`(() => { ${t} })()`:t,i;try{i=new Function("__scope",`with (__scope) { return ${n} };`).bind(r)}catch(o){return it(o,r,t,e)}return Tt[t]=o=>{let a;try{a=i(o)}catch(u){return it(u,r,t,e)}return a}}function it(r,t,e,n){Object.assign(r,{element:t,expression:e}),console.warn(`\u2234 ${r.message}

${n}=${e?`"${e}"

`:""}`,t),setTimeout(()=>{throw r},0)}function pe(r){return r.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,t=>"-"+t.toLowerCase())}var at=new WeakMap;function N(r,t){if(!r.children)return;if(at.has(r))return at.get(r);let e=x(t||{}),n=[],i=(o,a=o.parentNode)=>{if(o.attributes)for(let u=0;u<o.attributes.length;){let s=o.attributes[u];if(s.name[0]!==":"){u++;continue}o.removeAttribute(s.name);let l=s.value;if(!l)continue;let h=s.name.slice(1).split(":");for(let f of h){let d=E[f]||se;if(n.push(d(o,l,e,f)||(()=>{})),at.has(o)||o.parentNode!==a)return!1}}for(let u=0,s;s=o.children[u];u++)i(s,o)===!1&&u--};i(r);for(let o of n)bt(()=>o(e));return Object.seal(e),at.set(r,e),e}var de=N;var me=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},I=[],T=[],pr=typeof Uint8Array<"u"?Uint8Array:Array,Bt=!1;function ge(){Bt=!0;for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,e=r.length;t<e;++t)I[t]=r[t],T[r.charCodeAt(t)]=t;T["-".charCodeAt(0)]=62,T["_".charCodeAt(0)]=63}function dr(r){Bt||ge();var t,e,n,i,o,a,u=r.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o=r[u-2]==="="?2:r[u-1]==="="?1:0,a=new pr(u*3/4-o),n=o>0?u-4:u;var s=0;for(t=0,e=0;t<n;t+=4,e+=3)i=T[r.charCodeAt(t)]<<18|T[r.charCodeAt(t+1)]<<12|T[r.charCodeAt(t+2)]<<6|T[r.charCodeAt(t+3)],a[s++]=i>>16&255,a[s++]=i>>8&255,a[s++]=i&255;return o===2?(i=T[r.charCodeAt(t)]<<2|T[r.charCodeAt(t+1)]>>4,a[s++]=i&255):o===1&&(i=T[r.charCodeAt(t)]<<10|T[r.charCodeAt(t+1)]<<4|T[r.charCodeAt(t+2)]>>2,a[s++]=i>>8&255,a[s++]=i&255),a}function mr(r){return I[r>>18&63]+I[r>>12&63]+I[r>>6&63]+I[r&63]}function vr(r,t,e){for(var n,i=[],o=t;o<e;o+=3)n=(r[o]<<16)+(r[o+1]<<8)+r[o+2],i.push(mr(n));return i.join("")}function ve(r){Bt||ge();for(var t,e=r.length,n=e%3,i="",o=[],a=16383,u=0,s=e-n;u<s;u+=a)o.push(vr(r,u,u+a>s?s:u+a));return n===1?(t=r[e-1],i+=I[t>>2],i+=I[t<<4&63],i+="=="):n===2&&(t=(r[e-2]<<8)+r[e-1],i+=I[t>>10],i+=I[t>>4&63],i+=I[t<<2&63],i+="="),o.push(i),o.join("")}function st(r,t,e,n,i){var o,a,u=i*8-n-1,s=(1<<u)-1,l=s>>1,h=-7,f=e?i-1:0,d=e?-1:1,p=r[t+f];for(f+=d,o=p&(1<<-h)-1,p>>=-h,h+=u;h>0;o=o*256+r[t+f],f+=d,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=n;h>0;a=a*256+r[t+f],f+=d,h-=8);if(o===0)o=1-l;else{if(o===s)return a?NaN:(p?-1:1)*(1/0);a=a+Math.pow(2,n),o=o-l}return(p?-1:1)*a*Math.pow(2,o-n)}function Ee(r,t,e,n,i,o){var a,u,s,l=o*8-i-1,h=(1<<l)-1,f=h>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,v=n?1:-1,y=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=h):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),a+f>=1?t+=d/s:t+=d*Math.pow(2,1-f),t*s>=2&&(a++,s/=2),a+f>=h?(u=0,a=h):a+f>=1?(u=(t*s-1)*Math.pow(2,i),a=a+f):(u=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;r[e+p]=u&255,p+=v,u/=256,i-=8);for(a=a<<i|u,l+=i;l>0;r[e+p]=a&255,p+=v,a/=256,l-=8);r[e+p-v]|=y*128}var wr={}.toString,Ae=Array.isArray||function(r){return wr.call(r)=="[object Array]"};var yr=50;c.TYPED_ARRAY_SUPPORT=me.TYPED_ARRAY_SUPPORT!==void 0?me.TYPED_ARRAY_SUPPORT:!0;function It(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function M(r,t){if(It()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(r=new Uint8Array(t),r.__proto__=c.prototype):(r===null&&(r=new c(t)),r.length=t),r}function c(r,t,e){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(r,t,e);if(typeof r=="number"){if(typeof t=="string")throw new Error("If encoding is specified then the first argument must be a string");return Pt(this,r)}return Se(this,r,t,e)}c.poolSize=8192;c._augment=function(r){return r.__proto__=c.prototype,r};function Se(r,t,e,n){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer?Ar(r,t,e,n):typeof t=="string"?Er(r,t,e):Sr(r,t)}c.from=function(r,t,e){return Se(null,r,t,e)};c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array);function be(r){if(typeof r!="number")throw new TypeError('"size" argument must be a number');if(r<0)throw new RangeError('"size" argument must not be negative')}function gr(r,t,e,n){return be(t),t<=0?M(r,t):e!==void 0?typeof n=="string"?M(r,t).fill(e,n):M(r,t).fill(e):M(r,t)}c.alloc=function(r,t,e){return gr(null,r,t,e)};function Pt(r,t){if(be(t),r=M(r,t<0?0:Ct(t)|0),!c.TYPED_ARRAY_SUPPORT)for(var e=0;e<t;++e)r[e]=0;return r}c.allocUnsafe=function(r){return Pt(null,r)};c.allocUnsafeSlow=function(r){return Pt(null,r)};function Er(r,t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!c.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=Re(t,e)|0;r=M(r,n);var i=r.write(t,e);return i!==n&&(r=r.slice(0,i)),r}function Ut(r,t){var e=t.length<0?0:Ct(t.length)|0;r=M(r,e);for(var n=0;n<e;n+=1)r[n]=t[n]&255;return r}function Ar(r,t,e,n){if(t.byteLength,e<0||t.byteLength<e)throw new RangeError("'offset' is out of bounds");if(t.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return e===void 0&&n===void 0?t=new Uint8Array(t):n===void 0?t=new Uint8Array(t,e):t=new Uint8Array(t,e,n),c.TYPED_ARRAY_SUPPORT?(r=t,r.__proto__=c.prototype):r=Ut(r,t),r}function Sr(r,t){if(U(t)){var e=Ct(t.length)|0;return r=M(r,e),r.length===0||t.copy(r,0,0,e),r}if(t){if(typeof ArrayBuffer<"u"&&t.buffer instanceof ArrayBuffer||"length"in t)return typeof t.length!="number"||Wr(t.length)?M(r,0):Ut(r,t);if(t.type==="Buffer"&&Ae(t.data))return Ut(r,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Ct(r){if(r>=It())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+It().toString(16)+" bytes");return r|0}c.isBuffer=jr;function U(r){return!!(r!=null&&r._isBuffer)}c.compare=function(t,e){if(!U(t)||!U(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,o=0,a=Math.min(n,i);o<a;++o)if(t[o]!==e[o]){n=t[o],i=e[o];break}return n<i?-1:i<n?1:0};c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};c.concat=function(t,e){if(!Ae(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return c.alloc(0);var n;if(e===void 0)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=c.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var a=t[n];if(!U(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i};function Re(r,t){if(U(r))return r.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(r)||r instanceof ArrayBuffer))return r.byteLength;typeof r!="string"&&(r=""+r);var e=r.length;if(e===0)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return ut(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return Pe(r).length;default:if(n)return ut(r).length;t=(""+t).toLowerCase(),n=!0}}c.byteLength=Re;function br(r,t,e){var n=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,t>>>=0,e<=t))return"";for(r||(r="utf8");;)switch(r){case"hex":return Mr(this,t,e);case"utf8":case"utf-8":return xe(this,t,e);case"ascii":return Pr(this,t,e);case"latin1":case"binary":return Cr(this,t,e);case"base64":return Ur(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Dr(this,t,e);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}c.prototype._isBuffer=!0;function W(r,t,e){var n=r[t];r[t]=r[e],r[e]=n}c.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)W(this,e,e+1);return this};c.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)W(this,e,e+3),W(this,e+1,e+2);return this};c.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)W(this,e,e+7),W(this,e+1,e+6),W(this,e+2,e+5),W(this,e+3,e+4);return this};c.prototype.toString=function(){var t=this.length|0;return t===0?"":arguments.length===0?xe(this,0,t):br.apply(this,arguments)};c.prototype.equals=function(t){if(!U(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:c.compare(this,t)===0};c.prototype.inspect=function(){var t="",e=yr;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"};c.prototype.compare=function(t,e,n,i,o){if(!U(t))throw new TypeError("Argument must be a Buffer");if(e===void 0&&(e=0),n===void 0&&(n=t?t.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),e<0||n>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&e>=n)return 0;if(i>=o)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,i>>>=0,o>>>=0,this===t)return 0;for(var a=o-i,u=n-e,s=Math.min(a,u),l=this.slice(i,o),h=t.slice(e,n),f=0;f<s;++f)if(l[f]!==h[f]){a=l[f],u=h[f];break}return a<u?-1:u<a?1:0};function _e(r,t,e,n,i){if(r.length===0)return-1;if(typeof e=="string"?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:r.length-1),e<0&&(e=r.length+e),e>=r.length){if(i)return-1;e=r.length-1}else if(e<0)if(i)e=0;else return-1;if(typeof t=="string"&&(t=c.from(t,n)),U(t))return t.length===0?-1:we(r,t,e,n,i);if(typeof t=="number")return t=t&255,c.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,t,e):Uint8Array.prototype.lastIndexOf.call(r,t,e):we(r,[t],e,n,i);throw new TypeError("val must be string, number or Buffer")}function we(r,t,e,n,i){var o=1,a=r.length,u=t.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||t.length<2)return-1;o=2,a/=2,u/=2,e/=2}function s(p,v){return o===1?p[v]:p.readUInt16BE(v*o)}var l;if(i){var h=-1;for(l=e;l<a;l++)if(s(r,l)===s(t,h===-1?0:l-h)){if(h===-1&&(h=l),l-h+1===u)return h*o}else h!==-1&&(l-=l-h),h=-1}else for(e+u>a&&(e=a-u),l=e;l>=0;l--){for(var f=!0,d=0;d<u;d++)if(s(r,l+d)!==s(t,d)){f=!1;break}if(f)return l}return-1}c.prototype.includes=function(t,e,n){return this.indexOf(t,e,n)!==-1};c.prototype.indexOf=function(t,e,n){return _e(this,t,e,n,!0)};c.prototype.lastIndexOf=function(t,e,n){return _e(this,t,e,n,!1)};function Rr(r,t,e,n){e=Number(e)||0;var i=r.length-e;n?(n=Number(n),n>i&&(n=i)):n=i;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var u=parseInt(t.substr(a*2,2),16);if(isNaN(u))return a;r[e+a]=u}return a}function _r(r,t,e,n){return ft(ut(t,r.length-e),r,e,n)}function Te(r,t,e,n){return ft(Yr(t),r,e,n)}function Tr(r,t,e,n){return Te(r,t,e,n)}function xr(r,t,e,n){return ft(Pe(t),r,e,n)}function Ir(r,t,e,n){return ft(Nr(t,r.length-e),r,e,n)}c.prototype.write=function(t,e,n,i){if(e===void 0)i="utf8",n=this.length,e=0;else if(n===void 0&&typeof e=="string")i=e,n=this.length,e=0;else if(isFinite(e))e=e|0,isFinite(n)?(n=n|0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o=this.length-e;if((n===void 0||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return Rr(this,t,e,n);case"utf8":case"utf-8":return _r(this,t,e,n);case"ascii":return Te(this,t,e,n);case"latin1":case"binary":return Tr(this,t,e,n);case"base64":return xr(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ir(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}};c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ur(r,t,e){return t===0&&e===r.length?ve(r):ve(r.slice(t,e))}function xe(r,t,e){e=Math.min(r.length,e);for(var n=[],i=t;i<e;){var o=r[i],a=null,u=o>239?4:o>223?3:o>191?2:1;if(i+u<=e){var s,l,h,f;switch(u){case 1:o<128&&(a=o);break;case 2:s=r[i+1],(s&192)===128&&(f=(o&31)<<6|s&63,f>127&&(a=f));break;case 3:s=r[i+1],l=r[i+2],(s&192)===128&&(l&192)===128&&(f=(o&15)<<12|(s&63)<<6|l&63,f>2047&&(f<55296||f>57343)&&(a=f));break;case 4:s=r[i+1],l=r[i+2],h=r[i+3],(s&192)===128&&(l&192)===128&&(h&192)===128&&(f=(o&15)<<18|(s&63)<<12|(l&63)<<6|h&63,f>65535&&f<1114112&&(a=f))}}a===null?(a=65533,u=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|a&1023),n.push(a),i+=u}return Br(n)}var ye=4096;function Br(r){var t=r.length;if(t<=ye)return String.fromCharCode.apply(String,r);for(var e="",n=0;n<t;)e+=String.fromCharCode.apply(String,r.slice(n,n+=ye));return e}function Pr(r,t,e){var n="";e=Math.min(r.length,e);for(var i=t;i<e;++i)n+=String.fromCharCode(r[i]&127);return n}function Cr(r,t,e){var n="";e=Math.min(r.length,e);for(var i=t;i<e;++i)n+=String.fromCharCode(r[i]);return n}function Mr(r,t,e){var n=r.length;(!t||t<0)&&(t=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=t;o<e;++o)i+=Or(r[o]);return i}function Dr(r,t,e){for(var n=r.slice(t,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}c.prototype.slice=function(t,e){var n=this.length;t=~~t,e=e===void 0?n:~~e,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<t&&(e=t);var i;if(c.TYPED_ARRAY_SUPPORT)i=this.subarray(t,e),i.__proto__=c.prototype;else{var o=e-t;i=new c(o,void 0);for(var a=0;a<o;++a)i[a]=this[a+t]}return i};function g(r,t,e){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+t>e)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUIntLE=function(t,e,n){t=t|0,e=e|0,n||g(t,e,this.length);for(var i=this[t],o=1,a=0;++a<e&&(o*=256);)i+=this[t+a]*o;return i};c.prototype.readUIntBE=function(t,e,n){t=t|0,e=e|0,n||g(t,e,this.length);for(var i=this[t+--e],o=1;e>0&&(o*=256);)i+=this[t+--e]*o;return i};c.prototype.readUInt8=function(t,e){return e||g(t,1,this.length),this[t]};c.prototype.readUInt16LE=function(t,e){return e||g(t,2,this.length),this[t]|this[t+1]<<8};c.prototype.readUInt16BE=function(t,e){return e||g(t,2,this.length),this[t]<<8|this[t+1]};c.prototype.readUInt32LE=function(t,e){return e||g(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};c.prototype.readUInt32BE=function(t,e){return e||g(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};c.prototype.readIntLE=function(t,e,n){t=t|0,e=e|0,n||g(t,e,this.length);for(var i=this[t],o=1,a=0;++a<e&&(o*=256);)i+=this[t+a]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i};c.prototype.readIntBE=function(t,e,n){t=t|0,e=e|0,n||g(t,e,this.length);for(var i=e,o=1,a=this[t+--i];i>0&&(o*=256);)a+=this[t+--i]*o;return o*=128,a>=o&&(a-=Math.pow(2,8*e)),a};c.prototype.readInt8=function(t,e){return e||g(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]};c.prototype.readInt16LE=function(t,e){e||g(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};c.prototype.readInt16BE=function(t,e){e||g(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};c.prototype.readInt32LE=function(t,e){return e||g(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};c.prototype.readInt32BE=function(t,e){return e||g(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};c.prototype.readFloatLE=function(t,e){return e||g(t,4,this.length),st(this,t,!0,23,4)};c.prototype.readFloatBE=function(t,e){return e||g(t,4,this.length),st(this,t,!1,23,4)};c.prototype.readDoubleLE=function(t,e){return e||g(t,8,this.length),st(this,t,!0,52,8)};c.prototype.readDoubleBE=function(t,e){return e||g(t,8,this.length),st(this,t,!1,52,8)};function S(r,t,e,n,i,o){if(!U(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(e+n>r.length)throw new RangeError("Index out of range")}c.prototype.writeUIntLE=function(t,e,n,i){if(t=+t,e=e|0,n=n|0,!i){var o=Math.pow(2,8*n)-1;S(this,t,e,n,o,0)}var a=1,u=0;for(this[e]=t&255;++u<n&&(a*=256);)this[e+u]=t/a&255;return e+n};c.prototype.writeUIntBE=function(t,e,n,i){if(t=+t,e=e|0,n=n|0,!i){var o=Math.pow(2,8*n)-1;S(this,t,e,n,o,0)}var a=n-1,u=1;for(this[e+a]=t&255;--a>=0&&(u*=256);)this[e+a]=t/u&255;return e+n};c.prototype.writeUInt8=function(t,e,n){return t=+t,e=e|0,n||S(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t&255,e+1};function lt(r,t,e,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(r.length-e,2);i<o;++i)r[e+i]=(t&255<<8*(n?i:1-i))>>>(n?i:1-i)*8}c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e=e|0,n||S(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t&255,this[e+1]=t>>>8):lt(this,t,e,!0),e+2};c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e=e|0,n||S(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t&255):lt(this,t,e,!1),e+2};function ct(r,t,e,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(r.length-e,4);i<o;++i)r[e+i]=t>>>(n?i:3-i)*8&255}c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e=e|0,n||S(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255):ct(this,t,e,!0),e+4};c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e=e|0,n||S(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255):ct(this,t,e,!1),e+4};c.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e=e|0,!i){var o=Math.pow(2,8*n-1);S(this,t,e,n,o-1,-o)}var a=0,u=1,s=0;for(this[e]=t&255;++a<n&&(u*=256);)t<0&&s===0&&this[e+a-1]!==0&&(s=1),this[e+a]=(t/u>>0)-s&255;return e+n};c.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e=e|0,!i){var o=Math.pow(2,8*n-1);S(this,t,e,n,o-1,-o)}var a=n-1,u=1,s=0;for(this[e+a]=t&255;--a>=0&&(u*=256);)t<0&&s===0&&this[e+a+1]!==0&&(s=1),this[e+a]=(t/u>>0)-s&255;return e+n};c.prototype.writeInt8=function(t,e,n){return t=+t,e=e|0,n||S(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=t&255,e+1};c.prototype.writeInt16LE=function(t,e,n){return t=+t,e=e|0,n||S(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t&255,this[e+1]=t>>>8):lt(this,t,e,!0),e+2};c.prototype.writeInt16BE=function(t,e,n){return t=+t,e=e|0,n||S(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t&255):lt(this,t,e,!1),e+2};c.prototype.writeInt32LE=function(t,e,n){return t=+t,e=e|0,n||S(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):ct(this,t,e,!0),e+4};c.prototype.writeInt32BE=function(t,e,n){return t=+t,e=e|0,n||S(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255):ct(this,t,e,!1),e+4};function Ie(r,t,e,n,i,o){if(e+n>r.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function Ue(r,t,e,n,i){return i||Ie(r,t,e,4),Ee(r,t,e,n,23,4),e+4}c.prototype.writeFloatLE=function(t,e,n){return Ue(this,t,e,!0,n)};c.prototype.writeFloatBE=function(t,e,n){return Ue(this,t,e,!1,n)};function Be(r,t,e,n,i){return i||Ie(r,t,e,8),Ee(r,t,e,n,52,8),e+8}c.prototype.writeDoubleLE=function(t,e,n){return Be(this,t,e,!0,n)};c.prototype.writeDoubleBE=function(t,e,n){return Be(this,t,e,!1,n)};c.prototype.copy=function(t,e,n,i){if(n||(n=0),!i&&i!==0&&(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var o=i-n,a;if(this===t&&n<e&&e<i)for(a=o-1;a>=0;--a)t[a+e]=this[a+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(a=0;a<o;++a)t[a+e]=this[a+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o};c.prototype.fill=function(t,e,n,i){if(typeof t=="string"){if(typeof e=="string"?(i=e,e=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),t.length===1){var o=t.charCodeAt(0);o<256&&(t=o)}if(i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else typeof t=="number"&&(t=t&255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e=e>>>0,n=n===void 0?this.length:n>>>0,t||(t=0);var a;if(typeof t=="number")for(a=e;a<n;++a)this[a]=t;else{var u=U(t)?t:ut(new c(t,i).toString()),s=u.length;for(a=0;a<n-e;++a)this[a+e]=u[a%s]}return this};var kr=/[^+\/0-9A-Za-z-_]/g;function Lr(r){if(r=Fr(r).replace(kr,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Fr(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function Or(r){return r<16?"0"+r.toString(16):r.toString(16)}function ut(r,t){t=t||1/0;for(var e,n=r.length,i=null,o=[],a=0;a<n;++a){if(e=r.charCodeAt(a),e>55295&&e<57344){if(!i){if(e>56319){(t-=3)>-1&&o.push(239,191,189);continue}else if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(t-=3)>-1&&o.push(239,191,189),i=e;continue}e=(i-55296<<10|e-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((t-=1)<0)break;o.push(e)}else if(e<2048){if((t-=2)<0)break;o.push(e>>6|192,e&63|128)}else if(e<65536){if((t-=3)<0)break;o.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((t-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return o}function Yr(r){for(var t=[],e=0;e<r.length;++e)t.push(r.charCodeAt(e)&255);return t}function Nr(r,t){for(var e,n,i,o=[],a=0;a<r.length&&!((t-=2)<0);++a)e=r.charCodeAt(a),n=e>>8,i=e%256,o.push(i),o.push(n);return o}function Pe(r){return dr(Lr(r))}function ft(r,t,e,n){for(var i=0;i<n&&!(i+e>=t.length||i>=r.length);++i)t[i+e]=r[i];return i}function Wr(r){return r!==r}function jr(r){return r!=null&&(!!r._isBuffer||Ce(r)||$r(r))}function Ce(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function $r(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&Ce(r.slice(0,0))}var Vr={pcm8:(r,t,e,n,i)=>{let o=new Uint8Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=o[a++]-128;e[s][u]=l<0?l/128:l/127}},pcm16:(r,t,e,n,i)=>{let o=new Int16Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=o[a++];e[s][u]=l<0?l/32768:l/32767}},pcm24:(r,t,e,n,i)=>{let o=new Uint8Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=o[a++],h=o[a++],f=o[a++],d=l+(h<<8)+(f<<16),p=d>8388608?d-16777216:d;e[s][u]=p<0?p/8388608:p/8388607}},pcm32:(r,t,e,n,i)=>{let o=new Int32Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=o[a++];e[s][u]=l<0?l/2147483648:l/2147483647}},pcm32f:(r,t,e,n,i)=>{let o=new Float32Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s)e[s][u]=o[a++]},pcm64f:(r,t,e,n,i)=>{let o=new Float64Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s)e[s][u]=o[a++]}},Kr={pcm8:(r,t,e,n,i)=>{let o=new Uint8Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(e[s][u],1));l=(l*.5+.5)*255|0,o[a++]=l}},pcm16:(r,t,e,n,i)=>{let o=new Int16Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(e[s][u],1));l=(l<0?l*32768:l*32767)|0,o[a++]=l}},pcm24:(r,t,e,n,i)=>{let o=new Uint8Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(e[s][u],1));l=(l<0?16777216+l*8388608:l*8388607)|0,o[a++]=l>>0&255,o[a++]=l>>8&255,o[a++]=l>>16&255}},pcm32:(r,t,e,n,i)=>{let o=new Int32Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(e[s][u],1));l=(l<0?l*2147483648:l*2147483647)|0,o[a++]=l}},pcm32f:(r,t,e,n,i)=>{let o=new Float32Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(e[s][u],1));o[a++]=l}},pcm64f:(r,t,e,n,i)=>{let o=new Float64Array(r,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(e[s][u],1));o[a++]=l}}};function Me(r,t,e){let n="pcm"+t+(e?"f":""),i=r[n];if(!i)throw new TypeError("Unsupported data format: "+n);return i}function Zr(r){let t=0,e=0;r.buffer?(t=r.byteOffset,e=r.length,r=r.buffer):(t=0,e=r.byteLength);let n=new DataView(r);function i(){let l=n.getUint8(t);return t++,l}function o(){let l=n.getUint16(t,!0);return t+=2,l}function a(){let l=n.getUint32(t,!0);return t+=4,l}function u(l){let h="";for(let f=0;f<l;++f)h+=String.fromCharCode(i());return h}if(u(4)!=="RIFF")throw new TypeError("Invalid WAV file");if(a(),u(4)!=="WAVE")throw new TypeError("Invalid WAV file");let s;for(;t<e;){let l=u(4),h=a(),f=t+h;switch(l){case"fmt ":let d=o();if(d!==1&&d!==3)throw new TypeError("Unsupported format in WAV file: "+d.toString(16));s={format:"lpcm",floatingPoint:d===3,channels:o(),sampleRate:a(),byteRate:a(),blockSize:o(),bitDepth:o()};break;case"data":if(!s)throw new TypeError('Missing "fmt " chunk.');let p=Math.floor(h/s.blockSize),v=s.channels,y=s.sampleRate,b=[];for(let k=0;k<v;++k)b[k]=new Float32Array(p);return Me(Vr,s.bitDepth,s.floatingPoint)(r,t,b,v,p),{sampleRate:y,channelData:b}}t=f}}function zr(r,t){let e=t.sampleRate||16e3,n=!!(t.float||t.floatingPoint),i=n?32:t.bitDepth|0||16,o=r.length,a=r[0].length,u=new ArrayBuffer(44+a*o*(i>>3)),s=new DataView(u),l=0;function h(v){s.setUint8(l++,v)}function f(v){s.setUint16(l,v,!0),l+=2}function d(v){s.setUint32(l,v,!0),l+=4}function p(v){for(var y=0;y<v.length;++y)h(v.charCodeAt(y))}return p("RIFF"),d(u.byteLength-8),p("WAVE"),p("fmt "),d(16),f(n?3:1),f(o),d(e),d(e*o*(i>>3)),f(o*(i>>3)),f(i),p("data"),d(u.byteLength-44),Me(Kr,i,n)(u,l,r,o,a),u}var Mt={decode:Zr,encode:zr},bn=Mt.decode,De=Mt,Rn=Mt.encode;var Oe=function(){function r(){}return r.prototype.then=function(t,e){let n=new r,i=this.s;if(i){let o=1&i?t:e;if(o){try{_(n,1,o(this.v))}catch(a){_(n,2,a)}return n}return this}return this.o=function(o){try{let a=o.v;1&o.s?_(n,1,t?t(a):a):e?_(n,1,e(a)):_(n,2,a)}catch(a){_(n,2,a)}},n},r}();function _(r,t,e){if(!r.s){if(e instanceof Oe){if(!e.s)return void(e.o=_.bind(null,r,t));1&t&&(t=e.s),e=e.v}if(e&&e.then)return void e.then(_.bind(null,r,t),_.bind(null,r,2));r.s=t,r.v=e;let n=r.o;n&&n(r)}}var Hr=0,H=typeof WeakMap=="function"?WeakMap:function(){var r=typeof Symbol=="function"?Symbol(0):"__weak$"+ ++Hr;this.set=function(t,e){t[r]=e},this.get=function(t){return t[r]}};function Ft(r,t){return new Promise(function(e,n){r.onsuccess=function(){var i=r.result;t&&(i=t(i)),e(i)},r.onerror=function(){n(r.error)}})}function Ye(r,t){return Ft(r.openCursor(t),function(e){return e?[e.key,e.value]:[]})}function ke(r){return new Promise(function(t,e){r.oncomplete=function(){t()},r.onabort=function(){e(r.error)},r.onerror=function(){e(r.error)}})}function Dt(r){if(!function(t){return!!(typeof t=="number"||typeof t=="string"||typeof t=="object"&&t&&(Array.isArray(t)||"setUTCFullYear"in t||typeof ArrayBuffer=="function"&&ArrayBuffer.isView(t)||"byteLength"in t&&"length"in t))}(r))throw Error("kv-storage: The given value is not allowed as a key")}var Ne={};function Le(r,t){return Ye(r,We(t))}function We(r){return r===Ne?IDBKeyRange.lowerBound(-1/0):IDBKeyRange.lowerBound(r,!0)}var je=new H,pt=new H,dt=new H,$e=new H,ht=function(){};function Fe(r,t){return t(function(e,n){try{let l=function(){return pt.set(r,o),dt.set(r,void 0),{value:u,done:o===void 0}};var i=pt.get(r);if(i===void 0)return Promise.resolve({value:void 0,done:!0});var o,a,u,s=function(h,f){var d,p=-1;t:{for(var v=0;v<f.length;v++){var y=f[v][0];if(y){var b=y();if(b&&b.then)break t;if(b===h){p=v;break}}else p=v}if(p!==-1){do{for(var k=f[p][1];!k;)k=f[++p][1];var Q=k();if(Q&&Q.then){d=!0;break t}var Wt=f[p][2];p++}while(Wt&&!Wt());return Q}}let G=new Oe,tt=_.bind(null,G,2);return(d?Q.then(wt):b.then(function $(L){for(;;){if(L===h){p=v;break}if(++v===f.length){if(p!==-1)break;return void _(G,1,q)}if(y=f[v][0]){if((L=y())&&L.then)return void L.then($).then(void 0,tt)}else p=v}do{for(var F=f[p][1];!F;)F=f[++p][1];var q=F();if(q&&q.then)return void q.then(wt).then(void 0,tt);var jt=f[p][2];p++}while(jt&&!jt());_(G,1,q)})).then(void 0,tt),G;function wt($){for(;;){var L=f[p][2];if(!L||L())break;for(var F=f[++p][1];!F;)F=f[++p][1];if(($=F())&&$.then)return void $.then(wt).then(void 0,tt)}_(G,1,$)}}($e.get(r),[[function(){return"keys"},function(){return Promise.resolve(function(h,f){return Ye(h,We(f)).then(function(d){return d[0]})}(n,i)).then(function(h){u=o=h})}],[function(){return"values"},function(){return Promise.resolve(Le(n,i)).then(function(h){var f;o=(f=h)[0],u=a=f[1]})}],[function(){return"entries"},function(){return Promise.resolve(Le(n,i)).then(function(h){var f;a=(f=h)[1],u=(o=f[0])===void 0?void 0:[o,a]})}]]);return Promise.resolve(s&&s.then?s.then(l):l())}catch(l){return Promise.reject(l)}})}function kt(r,t){var e=new ht;return $e.set(e,r),je.set(e,t),pt.set(e,Ne),dt.set(e,void 0),e}ht.prototype.return=function(){pt.set(this,void 0)},ht.prototype.next=function(){var r=this,t=je.get(this);if(!t)return Promise.reject(new TypeError("Invalid this value"));var e,n=dt.get(this);return e=n!==void 0?n.then(function(){return Fe(r,t)}):Fe(this,t),dt.set(this,e),e},typeof Symbol=="function"&&Symbol.asyncIterator&&(ht.prototype[Symbol.asyncIterator]=function(){return this});var z=function(r,t,e){try{return D.get(r)===null&&function(n){var i=Ot.get(n);D.set(n,new Promise(function(o,a){var u=self.indexedDB.open(i,1);u.onsuccess=function(){var s=u.result;(function(l,h,f){if(l.objectStoreNames.length!==1||l.objectStoreNames[0]!==j)return f(Lt(h)),!1;var d=l.transaction(j,"readonly").objectStore(j);return!(d.autoIncrement||d.keyPath||d.indexNames.length)||(f(Lt(h)),!1)})(s,i,a)&&(s.onclose=function(){D.set(n,null)},s.onversionchange=function(){s.close(),D.set(n,null)},o(s))},u.onerror=function(){return a(u.error)},u.onupgradeneeded=function(){try{u.result.createObjectStore(j)}catch(s){a(s)}}}))}(r),Promise.resolve(D.get(r)).then(function(n){var i=n.transaction(j,t),o=i.objectStore(j);return e(i,o)})}catch(n){return Promise.reject(n)}},Ot=new H,D=new H,j="store",B=function(r){var t="kv-storage:"+r;D.set(this,null),Ot.set(this,t),this.backingStore={database:t,store:j,version:1}};function Lt(r){return new Error('kv-storage: database "'+r+'" corrupted')}B.prototype.set=function(r,t){try{return Dt(r),z(this,"readwrite",function(e,n){return t===void 0?n.delete(r):n.put(t,r),ke(e)})}catch(e){return Promise.reject(e)}},B.prototype.get=function(r){try{return Dt(r),z(this,"readonly",function(t,e){return Ft(e.get(r))})}catch(t){return Promise.reject(t)}},B.prototype.delete=function(r){try{return Dt(r),z(this,"readwrite",function(t,e){return e.delete(r),ke(t)})}catch(t){return Promise.reject(t)}},B.prototype.clear=function(){try{let i=function(){function o(){return Ft(self.indexedDB.deleteDatabase(Ot.get(r)))}var a=function(){if(t){try{t.close()}catch{}return Promise.resolve(new Promise(setTimeout)).then(function(){})}}();return a&&a.then?a.then(o):o()};var r=this,t,e=D.get(r),n=function(){if(e!==null){let a=function(){D.set(r,null)};var o=function(u,s){try{var l=Promise.resolve(e).then(function(h){t=h})}catch{return}return l&&l.then?l.then(void 0,function(){}):l}();return o&&o.then?o.then(a):a()}}();return n&&n.then?n.then(i):i()}catch(i){return Promise.reject(i)}},B.prototype.keys=function(){var r=this;return kt("keys",function(t){return z(r,"readonly",t)})},B.prototype.values=function(){var r=this;return kt("values",function(t){return z(r,"readonly",t)})},B.prototype.entries=function(){var r=this;return kt("entries",function(t){return z(r,"readonly",t)})},typeof Symbol=="function"&&Symbol.asyncIterator&&(B.prototype[Symbol.asyncIterator]=B.prototype.entries);var Gr=new B("default");var mt=44100,P=1024,qr=await(async()=>{let r=new Audio,t=OfflineAudioContext;return r.canPlayType("audio/ogg")||(t=(await import("./oggmented-bundle-ZFEURIUF.js")).default.OggmentedAudioContext),new t({sampleRate:mt,length:60*60*44100})})(),vt=r=>Math.floor(r*mt/P),Yt=r=>r*P/mt;async function Ve(r){console.time("fetch");let t=await fetch(r);if(!t.ok)throw new Error(`HTTP error: status=${t.status}`);let e=await t.arrayBuffer();return console.timeEnd("fetch"),e}async function Ke(r,t){console.time("decode");let e;try{e=await qr.decodeAudioData(r)}catch(n){console.log(n)}return console.timeEnd("decode"),e}async function Ze(r){console.time("wav encode");let t=r.getChannelData(0),e=De.encode([t],{sampleRate:r.sampleRate,float:!1,bitDepth:16});return console.timeEnd("wav encode"),e}async function ze(r){if(!r)return"";console.time("to waveform string");let t=r.getChannelData(0),e="",n=2;for(let i=0,o=P;i<t.length;){let a=0,u=0;for(;i<o;i++)a+=i>t.length?0:t[i]**2;let s=Math.sqrt(a/P),l=Math.min(100,Math.ceil(s*100*n));e+=String.fromCharCode(256+l),o+=P}return console.timeEnd("to waveform string"),e}function He(r,t,e){t=t??0,e=Math.min(e??r.length,r.length);for(var n=[],i,o=0;o<r.numberOfChannels;o++){n.push(i=new Float32Array(r.length-Math.abs(e-t)));var a=r.getChannelData(o);i.set(a.subarray(0,t),0),i.set(a.subarray(e),t)}return Nt(n)}function Ge(r,t=2){let e=Array.from({length:t},()=>new Float32Array(r));return Nt(e)}function Nt(r){let t=new AudioBuffer({length:r[0].length,numberOfChannels:r.length,sampleRate:mt});for(var e=0;e<t.numberOfChannels;e++)t.copyToChannel(r[e],e,0);return t}function qe(r,t,e){for(var n=[],i,o=0;o<r.numberOfChannels;o++){n.push(i=new Float32Array(r.length+e.length));var a=r.getChannelData(o);console.log("start",t),i.set(a.subarray(0,t),0),i.set(e.getChannelData(o),t),i.set(a.subarray(t),t+e.length)}return Nt(n)}window.BlobBuilder||=window.WebKitBlobBuilder||window.MozBlobBuilder;var m=de(document.querySelector(".waveedit"),{loading:!0,recording:!1,playing:!1,selecting:!1,startFrame:0,endFrame:null,volume:1,error:null,buffer:null,waveform:"",wavURL:"",handleCaret(r){m.startFrame=vt(m.audio.currentTime=Yt(r.target.selectionStart)),m.endFrame=null},handleInput(r){let t=this,{waveform:e}=m,n=t.selectionStart;e.length===t.value.length&&e===t.value||(clearTimeout(t._id),t._id=setTimeout(()=>{let i=t.value;if(i.length<e.length){let o=n*P,a=(n+e.length-i.length)*P;console.log("remove"),m.buffer=He(m.buffer,o,a)}else for(let o=0;o<i.length;o++)if(i[o]===" "){let u=o;for(;o<i.length&&i[o]===" ";o++);m.buffer=qe(m.buffer,u*P,Ge((o-u)*P))}m.render()},700))},timeChange(r){m.wavearea.selectionStart=m.wavearea.selectionEnd=m.startFrame=vt(m.audio.currentTime),m.wavearea.focus()},async render(){let{buffer:r}=m,t=await Ze(r),e=new Blob([t],{type:"audio/wav"});m.wavURL=URL.createObjectURL(e),m.audio.currentTime=Yt(m.wavearea.selectionStart),m.audio.onload=()=>{URL.revokeObjectURL(m.wavURL)};let n=await ze(r),i=m.wavearea.selectionStart;n!==m.waveform&&(m.waveform=n),m.wavearea.selectionStart=m.wavearea.selectionEnd=i},play(r){let{wavearea:t,audio:e}=m;m.playing=!0,m.startFrame=t.selectionStart;let n=[t.selectionStart,t.selectionEnd];m.endFrame=n[0]!==n[1]?n[1]:t.value.length;let i,o=()=>{let a=vt(e.currentTime)-m.startFrame,u=m.startFrame+a;m.selecting||(t.selectionStart=t.selectionEnd=u),m.endFrame&&u>=m.endFrame?e.pause():i=requestAnimationFrame(o)};return o(),t.focus(),()=>{m.playing=!1,cancelAnimationFrame(i),i=null,n[0]!==n[1]&&(t.selectionStart=startFrame,t.selectionEnd=endFrame),e.currentTime>=e.duration&&(t.selectionStart=t.selectionEnd=m.waveform.length),t.focus()}}}),Xe=["https://upload.wikimedia.org/wikipedia/commons/9/9c/Vivaldi_-_Magnificat_01_Magnificat.oga","https://upload.wikimedia.org/wikipedia/commons/c/cf/Caja_de_m%C3%BAsica_%28PianoConcerto5_Beethoven%29.ogg","https://upload.wikimedia.org/wikipedia/commons/9/96/Carcassi_Op_60_No_1.ogg"],Jr=r=>{let t=new URL(location.href);t.searchParams.set("src",r),history.pushState(null,"",t)};async function Qr(r=Xe[Math.floor(Math.random()*Xe.length)]){m.loading=!0;try{let t;console.log("loading default audio"),Jr(r),t=await Ve(r),m.buffer=await Ke(t),m.render()}catch(t){console.error(t),m.error=t.message}m.loading=!1}Qr();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
//# sourceMappingURL=waveplay.js.map
