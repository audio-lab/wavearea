import"./chunk-ABZDHW4W.js";function it(){throw new Error("Cycle detected")}function Et(){if(K>1)K--;else{for(var e,t=!1;Q!==void 0;){var r=Q;for(Q=void 0,At++;r!==void 0;){var n=r.o;if(r.o=void 0,r.f&=-3,!(8&r.f)&&Zt(r))try{r.c()}catch(i){t||(e=i,t=!0)}r=n}}if(At=0,K--,t)throw e}}var v=void 0,Q=void 0,K=0,At=0,nt=0;function Vt(e){if(v!==void 0){var t=e.n;if(t===void 0||t.t!==v)return t={i:0,S:e,p:v.s,n:void 0,t:v,e:void 0,x:void 0,r:t},v.s!==void 0&&(v.s.n=t),v.s=t,e.n=t,32&v.f&&e.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=v.s,t.n=void 0,v.s.n=t,v.s=t),t}}function b(e){this.v=e,this.i=0,this.n=void 0,this.t=void 0}b.prototype.h=function(){return!0};b.prototype.S=function(e){this.t!==e&&e.e===void 0&&(e.x=this.t,this.t!==void 0&&(this.t.e=e),this.t=e)};b.prototype.U=function(e){if(this.t!==void 0){var t=e.e,r=e.x;t!==void 0&&(t.x=r,e.e=void 0),r!==void 0&&(r.e=t,e.x=void 0),e===this.t&&(this.t=r)}};b.prototype.subscribe=function(e){var t=this;return Rt(function(){var r=t.value,n=32&this.f;this.f&=-33;try{e(r)}finally{this.f|=n}})};b.prototype.valueOf=function(){return this.value};b.prototype.toString=function(){return this.value+""};b.prototype.peek=function(){return this.v};Object.defineProperty(b.prototype,"value",{get:function(){var e=Vt(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){At>100&&it(),this.v=e,this.i++,nt++,K++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{Et()}}}});function Kt(e){return new b(e)}function Zt(e){for(var t=e.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function zt(e){for(var t=e.s;t!==void 0;t=t.n){var r=t.S.n;if(r!==void 0&&(t.r=r),t.S.n=t,t.i=-1,t.n===void 0){e.s=t;break}}}function qt(e){for(var t=e.s,r=void 0;t!==void 0;){var n=t.p;t.i===-1?(t.S.U(t),n!==void 0&&(n.n=t.n),t.n!==void 0&&(t.n.p=n)):r=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=n}e.s=r}function F(e){b.call(this,void 0),this.x=e,this.s=void 0,this.g=nt-1,this.f=4}(F.prototype=new b).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===nt))return!0;if(this.g=nt,this.f|=1,this.i>0&&!Zt(this))return this.f&=-2,!0;var e=v;try{zt(this),v=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(r){this.v=r,this.f|=16,this.i++}return v=e,qt(this),this.f&=-2,!0};F.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}b.prototype.S.call(this,e)};F.prototype.U=function(e){if(this.t!==void 0&&(b.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};F.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};F.prototype.peek=function(){if(this.h()||it(),16&this.f)throw this.v;return this.v};Object.defineProperty(F.prototype,"value",{get:function(){1&this.f&&it();var e=Vt(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function Ht(e){return new F(e)}function Xt(e){var t=e.u;if(e.u=void 0,typeof t=="function"){K++;var r=v;v=void 0;try{t()}catch(n){throw e.f&=-2,e.f|=8,St(e),n}finally{v=r,Et()}}}function St(e){for(var t=e.s;t!==void 0;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,Xt(e)}function ze(e){if(v!==this)throw new Error("Out-of-order effect");qt(this),v=e,this.f&=-2,8&this.f&&St(this),Et()}function tt(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}tt.prototype.c=function(){var e=this.S();try{!(8&this.f)&&this.x!==void 0&&(this.u=this.x())}finally{e()}};tt.prototype.S=function(){1&this.f&&it(),this.f|=1,this.f&=-9,Xt(this),zt(this),K++;var e=v;return v=this,ze.bind(this,e)};tt.prototype.N=function(){2&this.f||(this.f|=2,this.o=Q,Q=this)};tt.prototype.d=function(){this.f|=8,1&this.f||St(this)};function Rt(e){var t=new tt(e);try{t.c()}catch(r){throw t.d(),r}return t.d.bind(t)}Symbol.observable||=Symbol("observable");var Gt=e=>e&&!!(e[Symbol.observable]||e[Symbol.asyncIterator]||e.call&&e.set||e.subscribe||e.then),qe=new FinalizationRegistry(e=>e.call?.()),He=e=>e&&(()=>e.unsubscribe?.()),Jt=(e,t,r,n,i,o)=>e&&(o=He((e[Symbol.observable]?.()||e).subscribe?.(t,r,n))||e.set&&e.call?.(i,t)||(e.then?.(a=>(!i&&t(a),n?.()),r)||(async a=>{try{for await(a of e){if(i)return;t(a)}n?.()}catch(u){r?.(u)}})())&&(a=>i=1),qe.register(e,o),o);var Xe=e=>e&&e.peek,bt=e=>e&&e[Qt],Qt=Symbol("signal-struct");I.isStruct=bt;function I(e,t){if(bt(e)&&!t)return e;if(ot(e)){let r=Object.create(t||Object.getPrototypeOf(e)),n={},i=Object.getOwnPropertyDescriptors(e);for(let o in i){let a=i[o];if(a.get){let u=n[o]=Ht(a.get.bind(r));Object.defineProperty(r,o,{get(){return u.value},set:a.set?.bind(r),configurable:!1,enumerable:!0})}else{let u=a.value,s=Gt(u),l=n[o]=Xe(u)?u:Kt(s?void 0:ot(u)?Object.seal(I(u)):Array.isArray(u)?I(u):u);s&&Jt(u,h=>l.value=h),Object.defineProperty(r,o,{get(){return l.value},set(h){if(ot(h)){if(ot(l.value))try{Object.assign(l.value,h);return}catch{}l.value=Object.seal(I(h))}else Array.isArray(h)?l.value=I(h):l.value=h},enumerable:!0,configurable:!1})}}return Object.defineProperty(r,Qt,{configurable:!1,enumerable:!1,value:!0}),r}return Array.isArray(e)&&!bt(e[0])?e.map(r=>I(r)):e}function ot(e){return e&&e.constructor===Object}var Z=(e,t,r,n=null)=>{let i=0,o,a,u,s=r.length,l=t.length,{remove:h,same:c,insert:d,replace:p}=Z;for(;i<s&&i<l&&c(t[i],r[i]);)i++;for(;i<s&&i<l&&c(r[s-1],t[l-1]);)n=r[--l,--s];if(i==l)for(;i<s;)d(n,r[i++],e);else{for(o=t[i];i<s;)u=r[i++],a=o?o.nextSibling:n,c(o,u)?o=a:i<s&&c(r[i],a)?(p(o,u,e),o=a):d(o,u,e);for(;!c(o,n);)a=o.nextSibling,h(o,e),o=a}return r};Z.same=(e,t)=>e==t;Z.replace=(e,t,r)=>r.replaceChild(t,e);Z.insert=(e,t,r)=>r.insertBefore(t,e);Z.remove=(e,t)=>t.removeChild(e);var te=Z;var z={},Ge={},Je={},ee=e=>e===null?Ge:e===void 0?Je:typeof e=="number"||e instanceof Number?z[e]||(z[e]=new Number(e)):typeof e=="string"||e instanceof String?z[e]||(z[e]=new String(e)):typeof e=="boolean"||e instanceof Boolean?z[e]||(z[e]=new Boolean(e)):e;var A={},ne=(e,t,r,n)=>{let i=n.startsWith("on")&&n.slice(2),o=E(e,t,":"+n),a;if(o)return i?u=>{a&&ue(e,i,a),a=o(u),a&&ae(e,i,a)}:u=>ut(e,n,o(u))},ut=(e,t,r)=>{r==null||r===!1?e.removeAttribute(t):e.setAttribute(t,r===!0?"":typeof r=="number"||typeof r=="string"?r:"")};A[""]=(e,t)=>{let r=E(e,t,":");if(r)return n=>{let i=r(n);for(let o in i)ut(e,se(o),i[o])}};var ie=Symbol(":each"),_t=Symbol(":ref");A.ref=(e,t,r)=>{if(e.hasAttribute(":each")){e[_t]=t;return}r[t]=e};A.with=(e,t,r)=>{let n=E(e,t,"with");W(e,I(n(r),r))};A.if=(e,t)=>{let r=document.createTextNode(""),n=[E(e,t,":if")],i=[e],o=e;for(;(o=e.nextElementSibling)&&o.hasAttribute(":else");)o.removeAttribute(":else"),(t=o.getAttribute(":if"))?(o.removeAttribute(":if"),o.remove(),i.push(o),n.push(E(e,t,":else :if"))):(o.remove(),i.push(o),n.push(()=>1));return e.replaceWith(o=r),a=>{let u=n.findIndex(s=>s(a));i[u]!=o&&((o[ie]||o).replaceWith(o=i[u]||r),W(o,a))}};A.each=(e,t)=>{let r=Qe(t);if(!r)return at(new Error,e,t);let n=e[ie]=document.createTextNode("");e.replaceWith(n);let i=E(e,r.items,":each"),o=new WeakMap,a=new WeakMap,u=[];return s=>{let l=i(s);l?typeof l=="number"?l=Array.from({length:l},(d,p)=>[p,p+1]):Array.isArray(l)?l=l.map((d,p)=>[p+1,d]):typeof l=="object"?l=Object.entries(l):at(Error("Bad list value"),e,t,":each",l):l=[];let h=[],c=[];for(let[d,p]of l){let w=ee(p),y=a.get(w);if(y||(y=e.cloneNode(!0),a.set(w,y)),h.push(y),!o.has(w)){let R=Object.create(s);R[r.item]=p,r.index&&(R[r.index]=d),e[_t]&&(R[e[_t]]=y),o.set(w,R)}c.push(o.get(w))}te(n.parentNode,u,h,n),u=h;for(let d=0;d<h.length;d++)W(h[d],c[d])}};function Qe(e){let t=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,r=/^\s*\(|\)\s*$/g,n=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,i=e.match(n);if(!i)return;let o={};o.items=i[2].trim();let a=i[1].replace(r,"").trim(),u=a.match(t);return u?(o.item=a.replace(t,"").trim(),o.index=u[1].trim()):o.item=a,o}A.id=(e,t)=>{let r=E(e,t,":id"),n=i=>e.id=i||i===0?i:"";return i=>n(r(i))};A.class=(e,t)=>{let r=E(e,t,":class"),n=e.className;return i=>{let o=r(i);e.className=n+typeof o=="string"?o:(Array.isArray(o)?o:Object.entries(o).map(([a,u])=>u?a:"")).filter(Boolean).join(" ")}};A.style=(e,t)=>{let r=E(e,t,":style"),n=e.getAttribute("style")||"";return n.endsWith(";")||(n+="; "),i=>{let o=r(i);if(typeof o=="string")e.setAttribute("style",n+o);else for(let a in o)e.style[a]=o[a]}};A.text=(e,t)=>{let r=E(e,t,":text");return n=>{let i=r(n);e.textContent=i??""}};A.value=(e,t)=>{let r=E(e,t,":value"),n,i,o=e.type==="text"||e.type===""?a=>e.setAttribute("value",e.value=a??""):e.tagName==="TEXTAREA"||e.type==="text"||e.type===""?a=>(n=e.selectionStart,i=e.selectionEnd,e.setAttribute("value",e.value=a??""),n&&e.setSelectionRange(n,i)):e.type==="checkbox"?a=>(e.value=a?"on":"",ut(e,"checked",a)):e.type==="select-one"?a=>{for(let u in e.options)u.removeAttribute("selected");e.value=a,e.selectedOptions[0]?.setAttribute("selected","")}:a=>e.value=a;return a=>o(r(a))};var oe=Symbol("stop");A.on=(e,t)=>{let r=E(e,t,":on"),n={};return i=>{for(let o in n)ue(e,o,n[o]);n=r(i);for(let o in n)ae(e,o,n[o])}};var ae=(e,t,r)=>{if(t.indexOf("..")<0)e.addEventListener(t,r);else{let n=t.split("..").map(o=>o.startsWith("on")?o.slice(2):o),i=(o,a=0)=>{let u=s=>{e.removeEventListener(n[a],u),typeof(o=o.call(e,s))!="function"&&(o=()=>{}),++a<n.length?i(o,a):r[oe]||i(r)};e.addEventListener(n[a],u)};i(r)}},ue=(e,t,r)=>{t.indexOf("..")>=0&&(r[oe]=!0),e.removeEventListener(t,r)};A.data=(e,t)=>{let r=E(e,t,":data");return n=>{let i=r(n);for(let o in i)e.dataset[o]=i[o]}};A.aria=(e,t)=>{let r=E(e,t,":aria"),n=i=>{for(let o in i)ut(e,"aria-"+se(o),i[o]==null?null:i[o]+"")};return i=>n(r(i))};var re={};function E(e,t,r){let n=re[t];if(!n){let i=/^[\n\s]*if.*\(.*\)/.test(t)||/^(let|const)\s/.test(t)?`(() => { ${t} })()`:t;try{n=re[t]=new Function("__scope",`with (__scope) { return ${i} };`)}catch(o){return at(o,e,t,r)}}return i=>{let o;try{o=n.call(e,i)}catch(a){return at(a,e,t,r)}return o}}function at(e,t,r,n){Object.assign(e,{element:t,expression:r}),console.warn(`\u2234 ${e.message}

${n}=${r?`"${r}"

`:""}`,t),setTimeout(()=>{throw e},0)}function se(e){return e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,t=>"-"+t.toLowerCase())}var st=new WeakMap;function W(e,t){if(!e.children)return;if(st.has(e))return st.get(e);let r=I(t||{}),n=[],i=(o,a=o.parentNode)=>{if(o.attributes)for(let u=0;u<o.attributes.length;){let s=o.attributes[u];if(s.name[0]!==":"){u++;continue}o.removeAttribute(s.name);let l=s.value;if(!l)continue;let h=s.name.slice(1).split(":");for(let c of h){let d=A[c]||ne;if(n.push(d(o,l,r,c)||(()=>{})),st.has(o)||o.parentNode!==a)return!1}}for(let u=0,s;s=o.children[u];u++)i(s,o)===!1&&u--};i(e);for(let o of n)Rt(()=>o(r));return Object.seal(r),st.set(e,r),r}var le=W;var fe=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},T=[],x=[],tr=typeof Uint8Array<"u"?Uint8Array:Array,Bt=!1;function de(){Bt=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)T[t]=e[t],x[e.charCodeAt(t)]=t;x["-".charCodeAt(0)]=62,x["_".charCodeAt(0)]=63}function er(e){Bt||de();var t,r,n,i,o,a,u=e.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o=e[u-2]==="="?2:e[u-1]==="="?1:0,a=new tr(u*3/4-o),n=o>0?u-4:u;var s=0;for(t=0,r=0;t<n;t+=4,r+=3)i=x[e.charCodeAt(t)]<<18|x[e.charCodeAt(t+1)]<<12|x[e.charCodeAt(t+2)]<<6|x[e.charCodeAt(t+3)],a[s++]=i>>16&255,a[s++]=i>>8&255,a[s++]=i&255;return o===2?(i=x[e.charCodeAt(t)]<<2|x[e.charCodeAt(t+1)]>>4,a[s++]=i&255):o===1&&(i=x[e.charCodeAt(t)]<<10|x[e.charCodeAt(t+1)]<<4|x[e.charCodeAt(t+2)]>>2,a[s++]=i>>8&255,a[s++]=i&255),a}function rr(e){return T[e>>18&63]+T[e>>12&63]+T[e>>6&63]+T[e&63]}function nr(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(rr(n));return i.join("")}function ce(e){Bt||de();for(var t,r=e.length,n=r%3,i="",o=[],a=16383,u=0,s=r-n;u<s;u+=a)o.push(nr(e,u,u+a>s?s:u+a));return n===1?(t=e[r-1],i+=T[t>>2],i+=T[t<<4&63],i+="=="):n===2&&(t=(e[r-2]<<8)+e[r-1],i+=T[t>>10],i+=T[t>>4&63],i+=T[t<<2&63],i+="="),o.push(i),o.join("")}function ft(e,t,r,n,i){var o,a,u=i*8-n-1,s=(1<<u)-1,l=s>>1,h=-7,c=r?i-1:0,d=r?-1:1,p=e[t+c];for(c+=d,o=p&(1<<-h)-1,p>>=-h,h+=u;h>0;o=o*256+e[t+c],c+=d,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=n;h>0;a=a*256+e[t+c],c+=d,h-=8);if(o===0)o=1-l;else{if(o===s)return a?NaN:(p?-1:1)*(1/0);a=a+Math.pow(2,n),o=o-l}return(p?-1:1)*a*Math.pow(2,o-n)}function we(e,t,r,n,i,o){var a,u,s,l=o*8-i-1,h=(1<<l)-1,c=h>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,w=n?1:-1,y=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=h):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),a+c>=1?t+=d/s:t+=d*Math.pow(2,1-c),t*s>=2&&(a++,s/=2),a+c>=h?(u=0,a=h):a+c>=1?(u=(t*s-1)*Math.pow(2,i),a=a+c):(u=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=u&255,p+=w,u/=256,i-=8);for(a=a<<i|u,l+=i;l>0;e[r+p]=a&255,p+=w,a/=256,l-=8);e[r+p-w]|=y*128}var ir={}.toString,me=Array.isArray||function(e){return ir.call(e)=="[object Array]"};var or=50;f.TYPED_ARRAY_SUPPORT=fe.TYPED_ARRAY_SUPPORT!==void 0?fe.TYPED_ARRAY_SUPPORT:!0;function xt(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function k(e,t){if(xt()<t)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=f.prototype):(e===null&&(e=new f(t)),e.length=t),e}function f(e,t,r){if(!f.TYPED_ARRAY_SUPPORT&&!(this instanceof f))return new f(e,t,r);if(typeof e=="number"){if(typeof t=="string")throw new Error("If encoding is specified then the first argument must be a string");return Ut(this,e)}return ve(this,e,t,r)}f.poolSize=8192;f._augment=function(e){return e.__proto__=f.prototype,e};function ve(e,t,r,n){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer?sr(e,t,r,n):typeof t=="string"?ur(e,t,r):lr(e,t)}f.from=function(e,t,r){return ve(null,e,t,r)};f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array);function ye(e){if(typeof e!="number")throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function ar(e,t,r,n){return ye(t),t<=0?k(e,t):r!==void 0?typeof n=="string"?k(e,t).fill(r,n):k(e,t).fill(r):k(e,t)}f.alloc=function(e,t,r){return ar(null,e,t,r)};function Ut(e,t){if(ye(t),e=k(e,t<0?0:Tt(t)|0),!f.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}f.allocUnsafe=function(e){return Ut(null,e)};f.allocUnsafeSlow=function(e){return Ut(null,e)};function ur(e,t,r){if((typeof r!="string"||r==="")&&(r="utf8"),!f.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=ge(t,r)|0;e=k(e,n);var i=e.write(t,r);return i!==n&&(e=e.slice(0,i)),e}function It(e,t){var r=t.length<0?0:Tt(t.length)|0;e=k(e,r);for(var n=0;n<r;n+=1)e[n]=t[n]&255;return e}function sr(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return r===void 0&&n===void 0?t=new Uint8Array(t):n===void 0?t=new Uint8Array(t,r):t=new Uint8Array(t,r,n),f.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=f.prototype):e=It(e,t),e}function lr(e,t){if(P(t)){var r=Tt(t.length)|0;return e=k(e,r),e.length===0||t.copy(e,0,0,r),e}if(t){if(typeof ArrayBuffer<"u"&&t.buffer instanceof ArrayBuffer||"length"in t)return typeof t.length!="number"||Br(t.length)?k(e,0):It(e,t);if(t.type==="Buffer"&&me(t.data))return It(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Tt(e){if(e>=xt())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+xt().toString(16)+" bytes");return e|0}f.isBuffer=Ur;function P(e){return!!(e!=null&&e._isBuffer)}f.compare=function(t,r){if(!P(t)||!P(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var n=t.length,i=r.length,o=0,a=Math.min(n,i);o<a;++o)if(t[o]!==r[o]){n=t[o],i=r[o];break}return n<i?-1:i<n?1:0};f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};f.concat=function(t,r){if(!me(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return f.alloc(0);var n;if(r===void 0)for(r=0,n=0;n<t.length;++n)r+=t[n].length;var i=f.allocUnsafe(r),o=0;for(n=0;n<t.length;++n){var a=t[n];if(!P(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i};function ge(e,t){if(P(e))return e.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;typeof e!="string"&&(e=""+e);var r=e.length;if(r===0)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return lt(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return xe(e).length;default:if(n)return lt(e).length;t=(""+t).toLowerCase(),n=!0}}f.byteLength=ge;function fr(e,t,r){var n=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,t>>>=0,r<=t))return"";for(e||(e="utf8");;)switch(e){case"hex":return Ar(this,t,r);case"utf8":case"utf-8":return Se(this,t,r);case"ascii":return yr(this,t,r);case"latin1":case"binary":return gr(this,t,r);case"base64":return mr(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Er(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}f.prototype._isBuffer=!0;function j(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}f.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)j(this,r,r+1);return this};f.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)j(this,r,r+3),j(this,r+1,r+2);return this};f.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)j(this,r,r+7),j(this,r+1,r+6),j(this,r+2,r+5),j(this,r+3,r+4);return this};f.prototype.toString=function(){var t=this.length|0;return t===0?"":arguments.length===0?Se(this,0,t):fr.apply(this,arguments)};f.prototype.equals=function(t){if(!P(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:f.compare(this,t)===0};f.prototype.inspect=function(){var t="",r=or;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"};f.prototype.compare=function(t,r,n,i,o){if(!P(t))throw new TypeError("Argument must be a Buffer");if(r===void 0&&(r=0),n===void 0&&(n=t?t.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),r<0||n>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===t)return 0;for(var a=o-i,u=n-r,s=Math.min(a,u),l=this.slice(i,o),h=t.slice(r,n),c=0;c<s;++c)if(l[c]!==h[c]){a=l[c],u=h[c];break}return a<u?-1:u<a?1:0};function Ae(e,t,r,n,i){if(e.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof t=="string"&&(t=f.from(t,n)),P(t))return t.length===0?-1:he(e,t,r,n,i);if(typeof t=="number")return t=t&255,f.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):he(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function he(e,t,r,n,i){var o=1,a=e.length,u=t.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(e.length<2||t.length<2)return-1;o=2,a/=2,u/=2,r/=2}function s(p,w){return o===1?p[w]:p.readUInt16BE(w*o)}var l;if(i){var h=-1;for(l=r;l<a;l++)if(s(e,l)===s(t,h===-1?0:l-h)){if(h===-1&&(h=l),l-h+1===u)return h*o}else h!==-1&&(l-=l-h),h=-1}else for(r+u>a&&(r=a-u),l=r;l>=0;l--){for(var c=!0,d=0;d<u;d++)if(s(e,l+d)!==s(t,d)){c=!1;break}if(c)return l}return-1}f.prototype.includes=function(t,r,n){return this.indexOf(t,r,n)!==-1};f.prototype.indexOf=function(t,r,n){return Ae(this,t,r,n,!0)};f.prototype.lastIndexOf=function(t,r,n){return Ae(this,t,r,n,!1)};function cr(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var u=parseInt(t.substr(a*2,2),16);if(isNaN(u))return a;e[r+a]=u}return a}function hr(e,t,r,n){return pt(lt(t,e.length-r),e,r,n)}function Ee(e,t,r,n){return pt(xr(t),e,r,n)}function pr(e,t,r,n){return Ee(e,t,r,n)}function dr(e,t,r,n){return pt(xe(t),e,r,n)}function wr(e,t,r,n){return pt(Ir(t,e.length-r),e,r,n)}f.prototype.write=function(t,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r|0,isFinite(n)?(n=n|0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o=this.length-r;if((n===void 0||n>o)&&(n=o),t.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return cr(this,t,r,n);case"utf8":case"utf-8":return hr(this,t,r,n);case"ascii":return Ee(this,t,r,n);case"latin1":case"binary":return pr(this,t,r,n);case"base64":return dr(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return wr(this,t,r,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function mr(e,t,r){return t===0&&r===e.length?ce(e):ce(e.slice(t,r))}function Se(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],a=null,u=o>239?4:o>223?3:o>191?2:1;if(i+u<=r){var s,l,h,c;switch(u){case 1:o<128&&(a=o);break;case 2:s=e[i+1],(s&192)===128&&(c=(o&31)<<6|s&63,c>127&&(a=c));break;case 3:s=e[i+1],l=e[i+2],(s&192)===128&&(l&192)===128&&(c=(o&15)<<12|(s&63)<<6|l&63,c>2047&&(c<55296||c>57343)&&(a=c));break;case 4:s=e[i+1],l=e[i+2],h=e[i+3],(s&192)===128&&(l&192)===128&&(h&192)===128&&(c=(o&15)<<18|(s&63)<<12|(l&63)<<6|h&63,c>65535&&c<1114112&&(a=c))}}a===null?(a=65533,u=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|a&1023),n.push(a),i+=u}return vr(n)}var pe=4096;function vr(e){var t=e.length;if(t<=pe)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=pe));return r}function yr(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]&127);return n}function gr(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function Ar(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=_r(e[o]);return i}function Er(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}f.prototype.slice=function(t,r){var n=this.length;t=~~t,r=r===void 0?n:~~r,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<t&&(r=t);var i;if(f.TYPED_ARRAY_SUPPORT)i=this.subarray(t,r),i.__proto__=f.prototype;else{var o=r-t;i=new f(o,void 0);for(var a=0;a<o;++a)i[a]=this[a+t]}return i};function g(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}f.prototype.readUIntLE=function(t,r,n){t=t|0,r=r|0,n||g(t,r,this.length);for(var i=this[t],o=1,a=0;++a<r&&(o*=256);)i+=this[t+a]*o;return i};f.prototype.readUIntBE=function(t,r,n){t=t|0,r=r|0,n||g(t,r,this.length);for(var i=this[t+--r],o=1;r>0&&(o*=256);)i+=this[t+--r]*o;return i};f.prototype.readUInt8=function(t,r){return r||g(t,1,this.length),this[t]};f.prototype.readUInt16LE=function(t,r){return r||g(t,2,this.length),this[t]|this[t+1]<<8};f.prototype.readUInt16BE=function(t,r){return r||g(t,2,this.length),this[t]<<8|this[t+1]};f.prototype.readUInt32LE=function(t,r){return r||g(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};f.prototype.readUInt32BE=function(t,r){return r||g(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};f.prototype.readIntLE=function(t,r,n){t=t|0,r=r|0,n||g(t,r,this.length);for(var i=this[t],o=1,a=0;++a<r&&(o*=256);)i+=this[t+a]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*r)),i};f.prototype.readIntBE=function(t,r,n){t=t|0,r=r|0,n||g(t,r,this.length);for(var i=r,o=1,a=this[t+--i];i>0&&(o*=256);)a+=this[t+--i]*o;return o*=128,a>=o&&(a-=Math.pow(2,8*r)),a};f.prototype.readInt8=function(t,r){return r||g(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]};f.prototype.readInt16LE=function(t,r){r||g(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};f.prototype.readInt16BE=function(t,r){r||g(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};f.prototype.readInt32LE=function(t,r){return r||g(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};f.prototype.readInt32BE=function(t,r){return r||g(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};f.prototype.readFloatLE=function(t,r){return r||g(t,4,this.length),ft(this,t,!0,23,4)};f.prototype.readFloatBE=function(t,r){return r||g(t,4,this.length),ft(this,t,!1,23,4)};f.prototype.readDoubleLE=function(t,r){return r||g(t,8,this.length),ft(this,t,!0,52,8)};f.prototype.readDoubleBE=function(t,r){return r||g(t,8,this.length),ft(this,t,!1,52,8)};function S(e,t,r,n,i,o){if(!P(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}f.prototype.writeUIntLE=function(t,r,n,i){if(t=+t,r=r|0,n=n|0,!i){var o=Math.pow(2,8*n)-1;S(this,t,r,n,o,0)}var a=1,u=0;for(this[r]=t&255;++u<n&&(a*=256);)this[r+u]=t/a&255;return r+n};f.prototype.writeUIntBE=function(t,r,n,i){if(t=+t,r=r|0,n=n|0,!i){var o=Math.pow(2,8*n)-1;S(this,t,r,n,o,0)}var a=n-1,u=1;for(this[r+a]=t&255;--a>=0&&(u*=256);)this[r+a]=t/u&255;return r+n};f.prototype.writeUInt8=function(t,r,n){return t=+t,r=r|0,n||S(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=t&255,r+1};function ct(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>(n?i:1-i)*8}f.prototype.writeUInt16LE=function(t,r,n){return t=+t,r=r|0,n||S(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t&255,this[r+1]=t>>>8):ct(this,t,r,!0),r+2};f.prototype.writeUInt16BE=function(t,r,n){return t=+t,r=r|0,n||S(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=t&255):ct(this,t,r,!1),r+2};function ht(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>(n?i:3-i)*8&255}f.prototype.writeUInt32LE=function(t,r,n){return t=+t,r=r|0,n||S(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=t&255):ht(this,t,r,!0),r+4};f.prototype.writeUInt32BE=function(t,r,n){return t=+t,r=r|0,n||S(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=t&255):ht(this,t,r,!1),r+4};f.prototype.writeIntLE=function(t,r,n,i){if(t=+t,r=r|0,!i){var o=Math.pow(2,8*n-1);S(this,t,r,n,o-1,-o)}var a=0,u=1,s=0;for(this[r]=t&255;++a<n&&(u*=256);)t<0&&s===0&&this[r+a-1]!==0&&(s=1),this[r+a]=(t/u>>0)-s&255;return r+n};f.prototype.writeIntBE=function(t,r,n,i){if(t=+t,r=r|0,!i){var o=Math.pow(2,8*n-1);S(this,t,r,n,o-1,-o)}var a=n-1,u=1,s=0;for(this[r+a]=t&255;--a>=0&&(u*=256);)t<0&&s===0&&this[r+a+1]!==0&&(s=1),this[r+a]=(t/u>>0)-s&255;return r+n};f.prototype.writeInt8=function(t,r,n){return t=+t,r=r|0,n||S(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=t&255,r+1};f.prototype.writeInt16LE=function(t,r,n){return t=+t,r=r|0,n||S(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t&255,this[r+1]=t>>>8):ct(this,t,r,!0),r+2};f.prototype.writeInt16BE=function(t,r,n){return t=+t,r=r|0,n||S(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=t&255):ct(this,t,r,!1),r+2};f.prototype.writeInt32LE=function(t,r,n){return t=+t,r=r|0,n||S(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=t&255,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):ht(this,t,r,!0),r+4};f.prototype.writeInt32BE=function(t,r,n){return t=+t,r=r|0,n||S(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=t&255):ht(this,t,r,!1),r+4};function Re(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function be(e,t,r,n,i){return i||Re(e,t,r,4),we(e,t,r,n,23,4),r+4}f.prototype.writeFloatLE=function(t,r,n){return be(this,t,r,!0,n)};f.prototype.writeFloatBE=function(t,r,n){return be(this,t,r,!1,n)};function _e(e,t,r,n,i){return i||Re(e,t,r,8),we(e,t,r,n,52,8),r+8}f.prototype.writeDoubleLE=function(t,r,n){return _e(this,t,r,!0,n)};f.prototype.writeDoubleBE=function(t,r,n){return _e(this,t,r,!1,n)};f.prototype.copy=function(t,r,n,i){if(n||(n=0),!i&&i!==0&&(i=this.length),r>=t.length&&(r=t.length),r||(r=0),i>0&&i<n&&(i=n),i===n||t.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-r<i-n&&(i=t.length-r+n);var o=i-n,a;if(this===t&&n<r&&r<i)for(a=o-1;a>=0;--a)t[a+r]=this[a+n];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(a=0;a<o;++a)t[a+r]=this[a+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),r);return o};f.prototype.fill=function(t,r,n,i){if(typeof t=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),t.length===1){var o=t.charCodeAt(0);o<256&&(t=o)}if(i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!f.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else typeof t=="number"&&(t=t&255);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,t||(t=0);var a;if(typeof t=="number")for(a=r;a<n;++a)this[a]=t;else{var u=P(t)?t:lt(new f(t,i).toString()),s=u.length;for(a=0;a<n-r;++a)this[a+r]=u[a%s]}return this};var Sr=/[^+\/0-9A-Za-z-_]/g;function Rr(e){if(e=br(e).replace(Sr,""),e.length<2)return"";for(;e.length%4!==0;)e=e+"=";return e}function br(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function _r(e){return e<16?"0"+e.toString(16):e.toString(16)}function lt(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],a=0;a<n;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}else if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function xr(e){for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r)&255);return t}function Ir(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function xe(e){return er(Rr(e))}function pt(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function Br(e){return e!==e}function Ur(e){return e!=null&&(!!e._isBuffer||Ie(e)||Tr(e))}function Ie(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function Tr(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&Ie(e.slice(0,0))}var Pr={pcm8:(e,t,r,n,i)=>{let o=new Uint8Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=o[a++]-128;r[s][u]=l<0?l/128:l/127}},pcm16:(e,t,r,n,i)=>{let o=new Int16Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=o[a++];r[s][u]=l<0?l/32768:l/32767}},pcm24:(e,t,r,n,i)=>{let o=new Uint8Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=o[a++],h=o[a++],c=o[a++],d=l+(h<<8)+(c<<16),p=d>8388608?d-16777216:d;r[s][u]=p<0?p/8388608:p/8388607}},pcm32:(e,t,r,n,i)=>{let o=new Int32Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=o[a++];r[s][u]=l<0?l/2147483648:l/2147483647}},pcm32f:(e,t,r,n,i)=>{let o=new Float32Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s)r[s][u]=o[a++]},pcm64f:(e,t,r,n,i)=>{let o=new Float64Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s)r[s][u]=o[a++]}},Cr={pcm8:(e,t,r,n,i)=>{let o=new Uint8Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(r[s][u],1));l=(l*.5+.5)*255|0,o[a++]=l}},pcm16:(e,t,r,n,i)=>{let o=new Int16Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(r[s][u],1));l=(l<0?l*32768:l*32767)|0,o[a++]=l}},pcm24:(e,t,r,n,i)=>{let o=new Uint8Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(r[s][u],1));l=(l<0?16777216+l*8388608:l*8388607)|0,o[a++]=l>>0&255,o[a++]=l>>8&255,o[a++]=l>>16&255}},pcm32:(e,t,r,n,i)=>{let o=new Int32Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(r[s][u],1));l=(l<0?l*2147483648:l*2147483647)|0,o[a++]=l}},pcm32f:(e,t,r,n,i)=>{let o=new Float32Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(r[s][u],1));o[a++]=l}},pcm64f:(e,t,r,n,i)=>{let o=new Float64Array(e,t),a=0;for(let u=0;u<i;++u)for(let s=0;s<n;++s){let l=Math.max(-1,Math.min(r[s][u],1));o[a++]=l}}};function Be(e,t,r){let n="pcm"+t+(r?"f":"");console.log("encoder",n);let i=e[n];if(!i)throw new TypeError("Unsupported data format: "+n);return i}function Mr(e){let t=0,r=0;e.buffer?(t=e.byteOffset,r=e.length,e=e.buffer):(t=0,r=e.byteLength);let n=new DataView(e);function i(){let l=n.getUint8(t);return t++,l}function o(){let l=n.getUint16(t,!0);return t+=2,l}function a(){let l=n.getUint32(t,!0);return t+=4,l}function u(l){let h="";for(let c=0;c<l;++c)h+=String.fromCharCode(i());return h}if(u(4)!=="RIFF")throw new TypeError("Invalid WAV file");if(a(),u(4)!=="WAVE")throw new TypeError("Invalid WAV file");let s;for(;t<r;){let l=u(4),h=a(),c=t+h;switch(l){case"fmt ":let d=o();if(d!==1&&d!==3)throw new TypeError("Unsupported format in WAV file: "+d.toString(16));s={format:"lpcm",floatingPoint:d===3,channels:o(),sampleRate:a(),byteRate:a(),blockSize:o(),bitDepth:o()};break;case"data":if(!s)throw new TypeError('Missing "fmt " chunk.');let p=Math.floor(h/s.blockSize),w=s.channels,y=s.sampleRate,R=[];for(let O=0;O<w;++O)R[O]=new Float32Array(p);return Be(Pr,s.bitDepth,s.floatingPoint)(e,t,R,w,p),{sampleRate:y,channelData:R}}t=c}}function Nr(e,t){console.time("encode start");let r=t.sampleRate||16e3,n=!!(t.float||t.floatingPoint),i=n?32:t.bitDepth|0||16,o=e.length,a=e[0].length,u=new ArrayBuffer(44+a*o*(i>>3)),s=new DataView(u),l=0;function h(w){s.setUint8(l++,w)}function c(w){s.setUint16(l,w,!0),l+=2}function d(w){s.setUint32(l,w,!0),l+=4}function p(w){for(var y=0;y<w.length;++y)h(w.charCodeAt(y))}return p("RIFF"),d(u.byteLength-8),p("WAVE"),p("fmt "),d(16),c(n?3:1),c(o),d(r),d(r*o*(i>>3)),c(o*(i>>3)),c(i),p("data"),d(u.byteLength-44),console.timeEnd("encode start"),console.time("encode body"),Be(Cr,i,n)(u,l,e,o,a),console.timeEnd("encode body"),u}var Pt={decode:Mr,encode:Nr},sn=Pt.decode,Ue=Pt,ln=Pt.encode;var Me=function(){function e(){}return e.prototype.then=function(t,r){let n=new e,i=this.s;if(i){let o=1&i?t:r;if(o){try{_(n,1,o(this.v))}catch(a){_(n,2,a)}return n}return this}return this.o=function(o){try{let a=o.v;1&o.s?_(n,1,t?t(a):a):r?_(n,1,r(a)):_(n,2,a)}catch(a){_(n,2,a)}},n},e}();function _(e,t,r){if(!e.s){if(r instanceof Me){if(!r.s)return void(r.o=_.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(_.bind(null,e,t),_.bind(null,e,2));e.s=t,e.v=r;let n=e.o;n&&n(e)}}var kr=0,H=typeof WeakMap=="function"?WeakMap:function(){var e=typeof Symbol=="function"?Symbol(0):"__weak$"+ ++kr;this.set=function(t,r){t[e]=r},this.get=function(t){return t[e]}};function kt(e,t){return new Promise(function(r,n){e.onsuccess=function(){var i=e.result;t&&(i=t(i)),r(i)},e.onerror=function(){n(e.error)}})}function Ne(e,t){return kt(e.openCursor(t),function(r){return r?[r.key,r.value]:[]})}function Te(e){return new Promise(function(t,r){e.oncomplete=function(){t()},e.onabort=function(){r(e.error)},e.onerror=function(){r(e.error)}})}function Ct(e){if(!function(t){return!!(typeof t=="number"||typeof t=="string"||typeof t=="object"&&t&&(Array.isArray(t)||"setUTCFullYear"in t||typeof ArrayBuffer=="function"&&ArrayBuffer.isView(t)||"byteLength"in t&&"length"in t))}(e))throw Error("kv-storage: The given value is not allowed as a key")}var ke={};function Pe(e,t){return Ne(e,De(t))}function De(e){return e===ke?IDBKeyRange.lowerBound(-1/0):IDBKeyRange.lowerBound(e,!0)}var Oe=new H,wt=new H,mt=new H,Ye=new H,dt=function(){};function Ce(e,t){return t(function(r,n){try{let l=function(){return wt.set(e,o),mt.set(e,void 0),{value:u,done:o===void 0}};var i=wt.get(e);if(i===void 0)return Promise.resolve({value:void 0,done:!0});var o,a,u,s=function(h,c){var d,p=-1;t:{for(var w=0;w<c.length;w++){var y=c[w][0];if(y){var R=y();if(R&&R.then)break t;if(R===h){p=w;break}}else p=w}if(p!==-1){do{for(var O=c[p][1];!O;)O=c[++p][1];var et=O();if(et&&et.then){d=!0;break t}var jt=c[p][2];p++}while(jt&&!jt());return et}}let G=new Me,rt=_.bind(null,G,2);return(d?et.then(gt):R.then(function V(Y){for(;;){if(Y===h){p=w;break}if(++w===c.length){if(p!==-1)break;return void _(G,1,J)}if(y=c[w][0]){if((Y=y())&&Y.then)return void Y.then(V).then(void 0,rt)}else p=w}do{for(var L=c[p][1];!L;)L=c[++p][1];var J=L();if(J&&J.then)return void J.then(gt).then(void 0,rt);var $t=c[p][2];p++}while($t&&!$t());_(G,1,J)})).then(void 0,rt),G;function gt(V){for(;;){var Y=c[p][2];if(!Y||Y())break;for(var L=c[++p][1];!L;)L=c[++p][1];if((V=L())&&V.then)return void V.then(gt).then(void 0,rt)}_(G,1,V)}}(Ye.get(e),[[function(){return"keys"},function(){return Promise.resolve(function(h,c){return Ne(h,De(c)).then(function(d){return d[0]})}(n,i)).then(function(h){u=o=h})}],[function(){return"values"},function(){return Promise.resolve(Pe(n,i)).then(function(h){var c;o=(c=h)[0],u=a=c[1]})}],[function(){return"entries"},function(){return Promise.resolve(Pe(n,i)).then(function(h){var c;a=(c=h)[1],u=(o=c[0])===void 0?void 0:[o,a]})}]]);return Promise.resolve(s&&s.then?s.then(l):l())}catch(l){return Promise.reject(l)}})}function Mt(e,t){var r=new dt;return Ye.set(r,e),Oe.set(r,t),wt.set(r,ke),mt.set(r,void 0),r}dt.prototype.return=function(){wt.set(this,void 0)},dt.prototype.next=function(){var e=this,t=Oe.get(this);if(!t)return Promise.reject(new TypeError("Invalid this value"));var r,n=mt.get(this);return r=n!==void 0?n.then(function(){return Ce(e,t)}):Ce(this,t),mt.set(this,r),r},typeof Symbol=="function"&&Symbol.asyncIterator&&(dt.prototype[Symbol.asyncIterator]=function(){return this});var q=function(e,t,r){try{return D.get(e)===null&&function(n){var i=Dt.get(n);D.set(n,new Promise(function(o,a){var u=self.indexedDB.open(i,1);u.onsuccess=function(){var s=u.result;(function(l,h,c){if(l.objectStoreNames.length!==1||l.objectStoreNames[0]!==$)return c(Nt(h)),!1;var d=l.transaction($,"readonly").objectStore($);return!(d.autoIncrement||d.keyPath||d.indexNames.length)||(c(Nt(h)),!1)})(s,i,a)&&(s.onclose=function(){D.set(n,null)},s.onversionchange=function(){s.close(),D.set(n,null)},o(s))},u.onerror=function(){return a(u.error)},u.onupgradeneeded=function(){try{u.result.createObjectStore($)}catch(s){a(s)}}}))}(e),Promise.resolve(D.get(e)).then(function(n){var i=n.transaction($,t),o=i.objectStore($);return r(i,o)})}catch(n){return Promise.reject(n)}},Dt=new H,D=new H,$="store",C=function(e){var t="kv-storage:"+e;D.set(this,null),Dt.set(this,t),this.backingStore={database:t,store:$,version:1}};function Nt(e){return new Error('kv-storage: database "'+e+'" corrupted')}C.prototype.set=function(e,t){try{return Ct(e),q(this,"readwrite",function(r,n){return t===void 0?n.delete(e):n.put(t,e),Te(r)})}catch(r){return Promise.reject(r)}},C.prototype.get=function(e){try{return Ct(e),q(this,"readonly",function(t,r){return kt(r.get(e))})}catch(t){return Promise.reject(t)}},C.prototype.delete=function(e){try{return Ct(e),q(this,"readwrite",function(t,r){return r.delete(e),Te(t)})}catch(t){return Promise.reject(t)}},C.prototype.clear=function(){try{let i=function(){function o(){return kt(self.indexedDB.deleteDatabase(Dt.get(e)))}var a=function(){if(t){try{t.close()}catch{}return Promise.resolve(new Promise(setTimeout)).then(function(){})}}();return a&&a.then?a.then(o):o()};var e=this,t,r=D.get(e),n=function(){if(r!==null){let a=function(){D.set(e,null)};var o=function(u,s){try{var l=Promise.resolve(r).then(function(h){t=h})}catch{return}return l&&l.then?l.then(void 0,function(){}):l}();return o&&o.then?o.then(a):a()}}();return n&&n.then?n.then(i):i()}catch(i){return Promise.reject(i)}},C.prototype.keys=function(){var e=this;return Mt("keys",function(t){return q(e,"readonly",t)})},C.prototype.values=function(){var e=this;return Mt("values",function(t){return q(e,"readonly",t)})},C.prototype.entries=function(){var e=this;return Mt("entries",function(t){return q(e,"readonly",t)})},typeof Symbol=="function"&&Symbol.asyncIterator&&(C.prototype[Symbol.asyncIterator]=C.prototype.entries);var Dr=new C("default");var vt=44100,B=1024,X=e=>Math.floor(e*vt/B),yt=e=>e*B/vt,Le=e=>Math.ceil(X(e)/B),Or=await(async()=>{let e=new Audio,t=OfflineAudioContext;return e.canPlayType("audio/ogg")||(t=(await import("./oggmented-bundle-ZFEURIUF.js")).default.OggmentedAudioContext),new t({sampleRate:vt,length:60*60*44100})})();async function Fe(e){console.time("fetch");let t=await fetch(e);if(!t.ok)throw new Error(`HTTP error: status=${t.status}`);let r=await t.arrayBuffer();return console.timeEnd("fetch"),r}async function We(e,t){console.time("decode");let r;try{r=await Or.decodeAudioData(e)}catch(n){console.log(n)}return console.timeEnd("decode"),r}async function je(e){console.time("wav encode");let t=e.getChannelData(0),r=Ue.encode([t],{sampleRate:e.sampleRate,float:!1,bitDepth:16});return console.timeEnd("wav encode"),r}async function Ot(e){if(!e)return"";console.time("to waveform string");let t=e.getChannelData(0),r="",n=2;for(let i=0,o=B;i<t.length;){let a=0,u=0;for(;i<o;i++)a+=i>t.length?0:t[i]**2;let s=Math.sqrt(a/B),l=Math.min(100,Math.ceil(s*100*n));r+=String.fromCharCode(256+l),o+=B}return console.timeEnd("to waveform string"),r}function $e(e,t,r){t=t??0,r=Math.min(r??e.length,e.length);for(var n=[],i,o=0;o<e.numberOfChannels;o++){n.push(i=new Float32Array(e.length-Math.abs(r-t)));var a=e.getChannelData(o);i.set(a.subarray(0,t),0),i.set(a.subarray(r),t)}return Yt(n)}function Ve(e,t=2){let r=Array.from({length:t},()=>new Float32Array(e));return Yt(r)}function Yt(e){let t=new AudioBuffer({length:e[0].length,numberOfChannels:e.length,sampleRate:vt});for(var r=0;r<t.numberOfChannels;r++)t.copyToChannel(e[r],r,0);return t}function Ke(e,t,r){for(var n=[],i,o=0;o<e.numberOfChannels;o++){n.push(i=new Float32Array(e.length+r.length));var a=e.getChannelData(o);i.set(a.subarray(0,t),0),i.set(r.getChannelData(o),t),i.set(a.subarray(t),t+r.length)}return Yt(n)}window.BlobBuilder||=window.WebKitBlobBuilder||window.MozBlobBuilder;var Ft;document.addEventListener("mousedown",()=>Ft=!0);document.addEventListener("mouseup",()=>Ft=!1);var Wt=document.querySelector(".waveplay"),N=Wt.querySelector(".w-wavearea"),M=Wt.querySelector(".w-playback"),m=le(Wt,{loading:!0,recording:!1,playing:!1,selecting:!1,startFrame:0,volume:1,error:null,buffer:null,segments:[""],wavURL:"",lineWidth:240,handleCaret(e){m.startFrame=X(M.currentTime=yt(U().start))},handleKey(e){if(e.key==="Enter"){e.preventDefault();let t=U(),r=t.startNode.parentNode.dataset.id;if(!r)throw Error("Segment id is not found, strange");m.segments.splice(r,1,m.segments[r].slice(0,t.startNodeOffset),m.segments[r].slice(t.startNodeOffset)),m.segments=m.segments}},handleInput(e){let t=U().start,r=N.textContent,n=m.segments.join("");n.length===r.length&&n===r||(clearTimeout(N._id),N._id=setTimeout(()=>{if(r.length<n.length){let i=t*B,o=(t+n.length-r.length)*B;m.buffer=$e(m.buffer,i,o)}else{let i=r.match(/\s+/);if(i){let o=i.index,a=i[0].length;m.buffer=Ke(m.buffer,o*B,Ve(a*B))}}m.updateAudio()},700))},timeChange(e){document.activeElement!==N&&(U(m.startFrame=X(M.currentTime)),N.focus())},async updateAudio(){let{buffer:e}=m,t=await je(e),r=new Blob([t],{type:"audio/wav"});m.wavURL=URL.createObjectURL(r);let n=U();n&&(M.currentTime=yt(n.start)),M.onload=()=>{URL.revokeObjectURL(m.wavURL)};let i=await Ot(e);m.segments.join("")!==i&&(console.log("rerender"),m.segments=[i],n&&U(n.start))},play(e){m.playing=!0;let t=U();t||(t=U(0));let r=t.start,n=t.collapsed?X(M.duration):t.end,i,o=()=>{let a=X(M.currentTime)-m.startFrame,u=m.startFrame+a;Ft||U(u),n&&u>=n?M.pause():i=requestAnimationFrame(o)};return o(),N.focus(),()=>{m.playing=!1,cancelAnimationFrame(i),i=null,t.start!==t.end&&U(r,n),M.currentTime>=M.duration&&U(Le(M.duration).length),N.focus()}},timecode(e){let t=yt(e);return`${Math.floor(t/60).toFixed(0)}:${(t%60).toFixed(0).padStart(2,0)}`}}),U=(e,t=e)=>{let r=window.getSelection();if(e!=null){let i,o;r.removeAllRanges();let a=new Range,u=e;for(i=N.firstChild;u>i.firstChild.data.length;)u-=i.firstChild.data.length,i=i.nextSibling;a.setStart(i.firstChild,u);let s=t;for(o=N.firstChild;s>o.firstChild.data.length;)s-=o.firstChild.data.length,o=o.nextSibling;return a.setEnd(o.firstChild,s),r.addRange(a),{start:e,startNode:i,end:t,endNode:o,startNodeOffset:u,endNodeOffset:s,collapsed:r.isCollapsed}}if(!r.anchorNode||r.anchorNode.parentNode.parentNode!==N)return;e=r.anchorOffset,t=r.focusOffset;let n=r.anchorNode;for(;n=n.previousSibling;)e+=n.textContent.length;for(n=r.focusNode;n=n.previousSibling;)t+=n.textContent.length;return{start:e,startNode:r.anchorNode,startNodeOffset:r.anchorOffset,end:t,endNode:r.focusNode,endNodeOffset:r.focusOffset,collapsed:r.isCollapsed}},Ze=["https://upload.wikimedia.org/wikipedia/commons/c/cf/Caja_de_m%C3%BAsica_%28PianoConcerto5_Beethoven%29.ogg"],Lt=new URL(location);async function Lr(e){m.loading=!0,e||(e=Ze[Math.floor(Math.random()*Ze.length)],Lt.searchParams.set("src",e),history.pushState(null,"",Lt));try{let t;t=await Fe(e),m.buffer=await We(t),m.updateAudio(),m.segments=[await Ot(m.buffer)]}catch(t){console.error(t),m.error=t.message}m.loading=!1}Lr(Lt.searchParams.get("src"));
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
//# sourceMappingURL=waveplay.js.map
