<!-- Main waveedit demo. See use-case. -->
<!DOCTYPE html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Waveplay</title>

<link href="./main.css" rel="stylesheet"/>

<body>
  <div class="waveplay"
    :onmousedown.document="e=> (isMouseDown = true)"
    :onmouseup.document="e=> (isMouseDown = false)"
    >
    <div class="w-container" :onclick="handleCaret">
      <div class="w-loader wavefont"
        :if="loading"
        :with="{id:null, str:''}"
        :="if (loading) id=setInterval(()=>str+='.', 50); else clearInterval(id), str = '';"
        :text="str"
      >...</div>
      <!-- <file-attachment class="w-file" :if="!wavURL" directory :onfile-attachment-accepted="e=>console.log(e)">
        <input type="file" multiple />
      </file-attachment> -->
      <div contenteditable class="w-wavearea wavefont"
        :onkeydown="e => !e.key.startsWith('Arrow') && e.preventDefault()"
        :onkeydown.enter="handleEnter"
        :onkeydown.backspace="handleDelete"
        :onkeydown.delete="handleDelete"
        :onkeydown.space="handleSpace"
        :="this.style.setProperty('--linew', lineWidth)"
      ><p class="w-segment"
        :each="segment, id1 in segments" :key="id1"
        :text="segment"
        :data="{
          id: id1 - 1
        }"
        :timecodes="let offset = segment.offset, lines=Math.ceil(segment.length / lineWidth);
          return Array.from({length: lines}, (_,i)=>timecode(i*lineWidth + offset)).join('\n')"></p></div>
    </div>

    <audio class="w-playback" controls :onplay..onpause="play" :onseeking="timeChange"></audio>
  </div>

  <script type="module" src="./dist/waveplay.js"></script>
</body>