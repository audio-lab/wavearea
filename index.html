<!-- Main waveedit demo. See use-case. -->
<!DOCTYPE html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Waveplay</title>

<link href="./main.css" rel="stylesheet"/>

<body>
  <div class="waveplay">
    <div class="w-container">
      <div class="w-loader wavefont" :if="loading"
        :with="{id:null, str:''}"
        :="if (loading) id=setInterval(()=>str+='.', 50); else clearInterval(id), str = '';"
        :text="str"
      >...</div>
      <!-- <file-attachment class="w-file" :if="!wavURL" directory :onfile-attachment-accepted="e=>console.log(e)">
        <input type="file" multiple />
      </file-attachment> -->
      <div contenteditable class="w-wavearea wavefont"
        :onclick="handleCaret"
        :onkeydown="handleKey"
        :="this.style.setProperty('--linew', lineWidth)"
      ><p class="w-segment"
        :each="segment, id1 in segments"
        :text="segment"
        :data="{
          id:id1-1,
          offset: +(this.previousSibling?.dataset.offset || 0) + segment.length
        }"
        :timecodes="let offset = +(this.previousSibling?.dataset.offset || 0), lines=Math.ceil(segment.length / lineWidth);
          return Array.from({length: lines}, (_,i)=>timecode(i*lineWidth + offset)).join('\n')"></p></div>
    </div>

    <audio :if="wavURL" class="w-playback" controls :src="wavURL" :onplay..onpause="play" :onseeking="timeChange"></audio>
  </div>

  <script type="module" src="./dist/waveplay.js"></script>
</body>